<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="Shift_JIS">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>[HMM0051A] ●version キーワードの使い道は？ - 秀丸エディタＱ＆Ａ集</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="base.css">
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>

<p><span class="link_navigate"> <a href="HMM0050A.html">←前へ</a> <a href="HMM0052A.html">次へ→</a> <a href="qa_kinou.html">機能別Ｑ＆Ａ</a> <a href="qa_order.html">質問番号順Ｑ＆Ａ</a> </span></p>
<hr />
<h1 id="hmm0051a">[HMM0051A]</h1>
<h2 id="HMM0051A_01">●version キーワードの使い道は？</h2>
<div class="marginleft">
<dl>
<dt><img src="q.png" alt="Q." width="32" height="29" /></dt>
<dd><strong>秀丸マクロの新しいバージョンの機能を実装しているかどうか調べるためにversion キーワードを使ってみましたが、 文法エラーが回避できません。</strong>
</dd>
</dl>
<hr />
<dl>
<dt><img src="a.png" alt="A." width="32" height="29" /></dt>
<dd><p>version キーワードを使って、あるバージョンから実装されたマクロ命令を使うかどうか振り分けることは、 できそうに思えますができません。 秀丸エディタは少なくとも現在の仕様では、マクロはコンパイル後に実行されるため、 version キーワード を使っても、バージョン判別ルーチンが実行されること無く、 文法エラーがあるというダイアログを出して止まってしまいます。</p>
<p>では version の使い道が無いかというとそうでもなく、 あるバージョンの秀丸エディタで当該のマクロ実行に致命的なバグがあることが既に分かっている場合に、 そのバージョンの秀丸エディタでの実行を禁止させるために使うことができます。</p>
<p>また、マクロの構成ファイルが増えてしまいますが、ファイルを分ける方法もあります。</p>
<ul>
<li>バージョン判定してマクロ本体を実行するマクロ</li>
<li>実際に処理を行うマクロ</li>
</ul>
<div class="macro">
<pre><code>if(version &gt; 800){
    exexmacro &quot;実際に処理を行うマクロファイル名&quot;;
}else{
    message &quot;現在の秀丸エディタのバージョンでは実行できません。&quot;;
}
endmacro;</code></pre>
</div>
</dd>
</dl>
</div>
<hr />
<p><span class="link_navigate"> <a href="HMM0050A.html">←前へ</a> <a href="HMM0052A.html">次へ→</a> <a href="qa_kinou.html">機能別Ｑ＆Ａ</a> <a href="qa_order.html">質問番号順Ｑ＆Ａ</a> </span></p>
</body>
</html>
