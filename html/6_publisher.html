<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="Shift_JIS" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="author" content="h-tom" />
  <title>第VI部〜秀丸エディタ拡張モジュール　秀丸パブリッシャー</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="base.css" />
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="hmindex0.html"><img src="hide_by2.png" width="88" height="32" alt="Hidemaru Q and A" /></a></p>
<section id="TOP" class="level1">
<h1>第VI部〜秀丸エディタ拡張モジュール<br>　秀丸パブリッシャー</h1>
<hr />
<section id="INDEX" class="level2">
<h2>秀丸パブリッシャーとは?</h2>
<p>秀丸エディタ本体にも印刷機能がついていますが、機能は多くありません。</p>
<p>秀丸パブリッシャーを使う事で、以下の事が可能になります。</p>
<ul>
<li>印刷プレビュー</li>
<li>カラー印刷</li>
<li>秀丸エディタ本体での文字修飾をそのまま印刷</li>
</ul>
<p>秀丸パブリッシャーは「持ち出しキット」で使用している場合や、<a href="#STORE">ストアアプリ版秀丸エディタ</a>でも使用可なVer.5.08 が公開されていますが、秀丸エディタ Ver.8.00以上が必要です。</p>
<p>秀丸エディタ Ver.8.00未満の場合は、秀丸パブリッシャーのVer.4系を使用してください。ただし、「持ち出しキット」では使用できません。</p>
<div class="box_line">
<ul>
<li><p>秀丸パブリッシャーのVer.4は、以下の2種類が存在します。</p>
<ul>
<li>「Visual Basic版」</li>
<li>.NET Frameworkで作成した「64bit版」</li>
</ul>
<p><strong>「64bit版」とありますが 32bit版秀丸エディタ/32bit OS でも使用可能で、</strong>
<span class="font_red_bold">Windows Vista 以降は、32bit/64bit 秀丸エディタを問わずに、.NET Framework で作成した「64bit版」を使用する事を推奨しています。</span></p></li>
</ul>
</div>
<p>以降の説明は、「<span class="attention_red">Ver.5.02以降</span>」を前提にしています。</p>
<div class="title-li">
<ul>
<li>【1】<a href="#INSTALL">ダウンロード、インストールと秀丸エディタ本体の設定</a></li>
<li>【2】<a href="#PRINTOUT">印刷するには</a></li>
<li>【3】<a href="#TEMPLATE">印刷フォーマットを指定して印刷したい</a></li>
<li>【4】<a href="#WARNING">テンプレートの注意点</a></li>
</ul>
</div>
<section id="INSTALL" class="level3">
<h3>【1】ダウンロード、インストールと秀丸エディタ本体の設定</h3>
<div class="box_line">
<p><span id="STORE">ストアアプリ版の場合</span></p>
<ul>
<li>秀丸エディタ本体に同梱されているため、「秀丸パブリッシャー」のインストールは不要です(ストアアプリ版Ver.8.90以降)。</li>
<li>「秀丸パブリッシャー」だけをバージョンアップする事は出来ません。ストアアプリ版秀丸エディタのアップデート時に最新版の「秀丸パブリッシャー」が同梱されます。</li>
</ul>
</div>
<p>秀丸パブリッシャーは、以下の場所から入手可能です。</p>
<ul>
<li><p><a href="https://hide.maruo.co.jp/" class="externallink" target="_blank" rel="noopener">秀まるおのホームページ</a> - <a href="https://hide.maruo.co.jp/software/index.html" class="externallink" target="_blank" rel="noopener">ソフトウェア</a> -
<a href="https://hide.maruo.co.jp/software/hmpv.html" class="externallink" target="_blank" rel="noopener">秀丸パブリッシャー</a></p>
<p>2022/05/18 現在、以下のバージョンが公開されています。</p>
<ul>
<li>Ver.5.08　64bit/32bit共通(秀丸エディタ Ver.8.00以降が必要。ストアアプリ、持ち出しキット使用時でも動作可能)</li>
<li>Ver.4.25　64bit版(<span class="attention_red">32bit版秀丸エディタ/32bit OS でも使用可</span> .NET Framework 2.0 以上が必要)</li>
<li>Ver.4.16b　32bit版(Visual Basic版 Visual Basic6.0のランタイムライブラリが必要)</li>
</ul></li>
</ul>
<p>秀丸パブリッシャー自体は、フリーソフトウェアです。秀丸エディタ Ver.8.00 以上で使用する事が推奨されています。</p>
<p>インストールファイルは、64bit/32bit共通です。</p>
<p><img src="6_publisher_01.png" width="307" height="147" alt="インストール実行" /><br />
</p>
<p>ダウンロードしたファイルを実行するとインストール先を聞かれます。</p>
<p><img src="6_publisher_02.png" width="510" height="259" alt="インストール先の設定" /><br />
</p>
<p>インストールが完了すると、秀丸エディタ本体の設定を変えるようメッセージが表示されるので、「<span class="env">動作環境</span>」から設定を変更しましょう。</p>
<p><img src="6_publisher_03.png" width="510" height="259" alt="最終メッセージ" /><br />
</p>
<p>「ストアアプリ版」でも、使用するには「<span class="env">動作環境</span>」から設定を変更する必要があります。</p>
<p><img src="6_publisher_04.png" width="605" height="191" alt="秀丸エディタ本体側の印刷設定" /><br />
</p>
</section>
<section id="PRINTOUT" class="level3">
<h3>【2】印刷するには</h3>
<p>設定が多いですが、普通に印刷するだけなら、以下の2箇所を設定・確認後、印刷範囲・印刷部数を確認し、<span class="btn-push">「印刷」</span>ボタンを押すだけです。<br />
(デフォルトでテンプレートは「_標準印刷」が選択されています)</p>
<ul>
<li><p>「設定の一覧」にある「プリンタ/用紙」を選択し、使用するプリンターと用紙サイズ、向きを確認・設定。</p>
<p><img src="6_publisher_05.png" width="630" height="426" alt="プリンター/用紙" /><br />
</p></li>
<li><p>「設定の一覧」にある「本文BOX」を選択し、余白やフォント、フォントサイズ、カラー印刷など設定。<br />
行番号や、ファイル名の印刷なども「本文BOX」の設定で可能です。</p>
<p><img src="6_publisher_06.png" width="538" height="243" alt="本文BOX" /><br />
</p>
<ul>
<li>「カラー印刷」にチェックを入れると、「フォント修飾再現」は操作できなくなります。
(強制的にONになり、OFFにできない)</li>
<li>「背景色は白にする」は、カラー印刷じゃない場合も設定できますが、「カラー印刷」が有効でないと意味がないです。</li>
<li>「フォント修飾再現」は、「ファイルタイプ別設定-デザイン」で設定したスタイルを印刷時にも適用するか、どうかです。</li>
<li>「編集記号の印刷」は、通常印刷されない、タブ文字、改行文字、全角空白、半角空白を印刷します。<br />
実際に印刷されるのは、「<span class="filetype">ファイルタイプ別の設定</span>」で表示するように設定してある「編集記号」だけです。つまり、印刷するファイルの設定に影響されます。画面に表示されない編集記号は、チェックを入れても印刷されません。</li>
<li>フォントに<strong>「(編集中のフォント)」</strong>を指定すると、秀丸エディタ本体で使用されているフォントを使用します。<br />
<img src="6_publisher_21.png" width="269" height="32" alt="編集中のフォント設定" /><br />
</li>
</ul></li>
</ul>
<p><span class="attention_red">注意</span></p>
<ul>
<li><p>「余白」等で数値を入力可能な箇所がありますが、キーボードから直接数値を入力して「Enter」を押すと、印刷が始まってしまいます。(IMEがOFFの場合)</p>
<p>これは、デフォルトのボタンが「印刷」に設定されているからです。項目を移動するつもりで「Enter」を押してしまうと、印刷が始まってしまうので注意してください。</p></li>
</ul>
</section>
<section id="TEMPLATE" class="level3">
<h3>【3】印刷フォーマットを指定して印刷したい</h3>
<p>ファイル名の表示やページ番号の印刷は「本文BOX」の設定で可能ですが、テンプレートを編集する事で以下の事が可能になります。</p>
<ul>
<li>本文とは別のフォントで「ファイル名」や「ページ番号」を印刷したい</li>
<li>「ページ番号」や「ファイル名」の印字方法を変えたい</li>
<li>「ページ番号」や「ファイル名」の印刷する場所を変えたい</li>
</ul>
<section id="TEMPLATE-1" class="level4">
<h4>テンプレートの簡単な説明</h4>
<ul>
<li><p>秀丸パブリッシャーで印刷するには、「テンプレート」を作成し指定する必要があります。
Wordなどワープロソフトと違い、印刷対象のファイル内に印刷設定を保存できないため、印刷するテキストと印刷設定を記録する「テンプレート」は別のファイルになります。</p>
<p>つまり指定されたテンプレートに合わせ、本文を印刷する事になります。</p></li>
<li><p>「テンプレート」には、用紙内に「BOX」という印刷エリアを配置し、設定する必要があります。</p>
<p>「BOX」は通常の「BOX」と「本文BOX」の2種類あり、配置は「レイアウト編集」で行います。</p></li>
<li><p>「テンプレート」には、「本文BOX」がデフォルトで配置され、削除はできません。「本文BOX」は印刷するファイルの内容が挿入される場所なので、必ず1個必要になります。
(新規でテンプレートを作成すると、「本文BOX」がデフォルトで配置されます)</p></li>
<li><p>通常の「BOX」には、記述した内容が、そのまま表示/印刷されます。ワープロでいうところの、ヘッダー/フッターのような使い方になります。固定された文字列だけでなく、ページ番号や、ファイル名、フルパス、日時などが設定できます。</p></li>
</ul>
</section>
<section id="TEMPLATE-2" class="level4">
<h4>テンプレートの編集</h4>
<p>では、テンプレートを実際に作成・編集してみましょう。</p>
<p>テンプレート名が表示されている箇所の横にある、<span class="btn-push">「...」</span>ボタンを押して、テンプレートの一覧画面を表示させます。</p>
<p><img src="6_publisher_07.png" width="630" height="101" alt="テンプレート一覧表示ボタン" /><br />
</p>
<p>この画面で、テンプレート新規作成、コピー、削除等が可能です。今回は<strong>"_標準印刷"</strong>をコピーして、<span class="attention_red">"テスト用"</span>という名前でテスト用のテンプレートを作り、編集していきます。</p>
<p><img src="6_publisher_08.png" width="406" height="177" alt="テンプレート一覧ダイアログ" /><br />
</p>
<p>テンプレートは、用紙の上から順番に、以下の校正で作成します。</p>
<ul>
<li>ファイル名(フルパス)</li>
<li>ファイルの作成日時</li>
<li>印刷日時</li>
<li>本文</li>
<li>ページ番号</li>
</ul>
<p>まずは、用紙と、余白を設定してください。</p>
<p><span class="btn-push">「レイアウト編集」</span>ボタンを押すと、編集画面が開きます。初期状態では、マージンいっぱいまで、本文BOX が配置されているだけです。</p>
<ol type="1">
<li><p>他のBOXを配置するために、本文ボックスの高さを適当に変えて、BOXを配置する場所を作ります。
BOXは、重ねる事が可能なので、ずらさないと印刷時に重なってしまいます。<br />
<img src="6_publisher_09.png" width="432" height="325" alt="レイアウト-本文BOX" /><br />
</p></li>
<li><p>ファイル名表示用のBOXを追加します。新規のBOXを追加する方法は以下になります。</p>
<ul>
<li><p>余白部分の右クリックメニュー</p>
<p><img src="6_publisher_10.png" width="411" height="329" alt="レイアウト-BOXの追加" /><br />
</p></li>
<li><p>編集画面のツールバー</p>
<p><img src="6_publisher_11.png" width="436" height="255" alt="レイアウト-BOXの追加" /><br />
</p></li>
</ul>
<p>「BOXを新規に追加」を選択すると、レイアウト編集画面に「BOX」が追加されます。</p>
<p>BOXを選択しダブルクリックすると、プロパティが開き、フォントや表示する内容などを設定する事ができます。プロパティ画面の設定に関しての詳細は「ヘルプ」を参照の事。</p>
<p><img src="6_publisher_12.png" width="738" height="482" alt="レイアウト-BOXのプロパティ" /><br />
</p>
<p>今回はファイル名を表示するので、「属性」を「ファイル名(フルパス)」にし、フォントやサイズ、スタイルは、好みにあわせて設定を行います。</p>
<p><img src="6_publisher_13.png" width="306" height="132" alt="レイアウト-属性の設定" /><br />
</p>
<p>設定後、<span class="btn-push">「OK」</span>ボタンを押すと、設定内容に合わせBOXの表示が変わるので、設定内容の確認ができます。</p>
<p>「左」と「上」で座標を、「幅」と「高さ」でサイズの指定が可能ですが、マウスを使用しBOX自体を動かしたり、サイズを変更する事も可能です。</p></li>
<li><p>同様に、ファイルの作成日時、印刷日時、ページ番号用のBOXを追加していきます。</p>
<p>「属性」をそれぞれ</p>
<ul>
<li>ファイルの作成日時は「タイムスタンプ」</li>
<li>印刷日時は「時間」</li>
<li>ページ番号は「ページ番号」</li>
</ul>
<p>に設定してください。</p>
<p>ファイルの作成日時、印刷日を選択した場合、書式に「YYYY/MM/DD(W) hh:mm:ss」がセットされます。書式に指定されている文字の詳細は、<span class="btn-push">「ヘルプ」</span>ボタンを押すと表示されるヘルプで、確認する事ができます。</p></li>
<li><p>ここでレイアウト編集画面を閉じ、プレビューで確認します。</p>
<p>"ファイルの作成日時"と"印刷日時"を追加しましたが、ぱっと見でどちらが何の日時なのかわかりません。<br />
<img src="6_publisher_14.png" width="354" height="276" alt="プレビュー1" /><br />
</p>
<p>そこで、各日時の前に"<strong>ファイル作成日：</strong>"と"<strong>印刷日時：</strong>"という文字を<span class="attention_red">追加</span>し、年月日の表示も変更します。<br />
<img src="6_publisher_15.png" width="375" height="278" alt="プレビュー2" /><br />
</p>
<p>年月日の表示を変更するには、「書式」を変更します。</p>
<pre><code>    変更前の「書式」　YYYY/MM/DD(W) hh:mm:ss
    変更後の「書式」　YYYY年MM月DD日（W曜日）</code></pre>
<p>文字を追加する方法は、いくつかあります。(例として「ファイルの作成日時」の場合)</p>
<ul>
<li><p>"ファイルの作成日時"を表示しているBOXの前に新たにBOXを追加し、「属性」は"通常のテキスト"、「テキスト」に"ファイル作成日："を指定する。</p></li>
<li><p>BOXのプロパティにある、「属性」はそのままで、「書式」を変更する。</p>
<pre><code>変更前の「書式」　YYYY年MM月DD日（W曜日）
変更後の「書式」　ファイル作成日：YYYY年MM月DD日（W曜日）</code></pre></li>
<li><p>BOXのプロパティにある、「属性」を"通常のテキスト"とし、「テキスト」を変更する。</p>
<pre><code>変更後の「テキスト」　ファイル作成日：%timestamp%</code></pre>
<p>「テキスト」中に「属性」の内容を取り込みたい場合は、「属性を示す文字列」を%で囲みます。(例:%filename%)<br />
%で囲む場合は、「属性を示す文字列」は全て小文字で記述する必要があります。</p>
<pre><code>OK：%filename%
NG：%FILENAME%
NG：%FileName%</code></pre>
<div class="table_border">
<table>
<caption>「属性」と「属性を示す文字列」</caption>
<thead>
<tr class="header">
<th style="text-align: left;">属性</th>
<th style="text-align: left;">属性を示す文字列</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ファイル名（フルパス）</td>
<td style="text-align: left;">filename</td>
</tr>
<tr class="even">
<td style="text-align: left;">ファイル名</td>
<td style="text-align: left;">basename</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ディレクトリ名</td>
<td style="text-align: left;">directory</td>
</tr>
<tr class="even">
<td style="text-align: left;">ページ番号</td>
<td style="text-align: left;">pagenum</td>
</tr>
<tr class="odd">
<td style="text-align: left;">時間</td>
<td style="text-align: left;">date</td>
</tr>
<tr class="even">
<td style="text-align: left;">タイムスタンプ</td>
<td style="text-align: left;">timestamp</td>
</tr>
</tbody>
</table>
</div>
<p>「属性」が"通常のテキスト"の場合、「テキスト」の内容が、「属性を示す文字列」と一致してしまうと、その内容が表示されてしまいます。
(「属性」"通常のテキスト"で、「テキスト」が filename だと、フルパスが表示される)</p>
<p>大文字小文字は無視、前後の空白も無視されるので、FileName 等でも一致してしまいます。空白以外の文字があると大丈夫です。</p>
<pre><code>テキストが「filename」や「FILENAME」だと フルパスに変換される。
テキストが「filename:%filename%」だと問題ない。</code></pre>
<p>「時間」や「タイムスタンプ」の場合、表示される書式は、一度も書式を設定したことのない場合はデフォルト値(「YYYY/MM/DD」)が、以前書式を設定したことがある場合は、その書式が使用されます。</p></li>
</ul></li>
<li><p>後は実際に印刷かプレビューで結果を確認し、修正箇所があれば、再度テンプレートを修正してください。</p></li>
</ol>
<p>以上、簡単ですがテンプレート作成例です。今回、本文BOXは1個でしたが、2個にして、冊子印刷も可能です。詳細は秀丸パブリッシャーのヘルプを参照してください。</p>
</section>
</section>
<section id="WARNING" class="level3">
<h3>【4】テンプレートの注意点</h3>
<ul>
<li><p>BOX のスタイルについて</p>
<p>BOXで指定可能なスタイルは以下になります。</p>
<p><img src="6_publisher_19.png" width="634" height="222" alt="BOXのスタイル" /><br />
</p>
<p>太文字、イタリック、下線は重複して指定できます。</p></li>
<li><p>テンプレートファイルですが、一時的な設定のつもりで設定を変えてしまうと、その設定が保存されてしまいます。<br />
(例えば、フォントの設定等)</p>
<pre><code>印刷 → 印刷ダイアログ開く → 一時的なつもりでフォントを変更  → 印刷実行</code></pre>
<p>と操作すると、変更内容はテンプレートに保存されます。</p>
<p>設定変更を行っても、テンプレートへ保存しないようにするには、「テンプレート上書き禁止」をチェックしてください。</p>
<p><img src="6_publisher_16.png" width="630" height="102" alt="テンプレート上書き禁止" /><br />
</p></li>
<li><p>現状、BOXではUnicode特有の文字を指定できません。Shift_JISに含まれる文字のみ表示可能です。</p>
<p>ただし、「属性」をファイル名にした場合(フルパスも含む)は、ファイル名にUnicode特有の文字があっても正常に表示されます。</p></li>
<li><p>テンプレートの保存場所は、「秀丸パブリッシャー」のダイアログから確認できます。</p>
<p>「印刷」を実行し、秀丸パブリッシャーのダイアログを表示させます。ダイアログ左上のアイコン部分をクリックすると、メニューが表示されるので「設定」を選択します。</p>
<p><span class="box_line">ストアアプリ版の場合：「最新バージョンの確認」はありません。</span></p>
<p><img src="6_publisher_17.png" width="348" height="186" alt="設定メニュー" /><br />
</p>
<p>「秀丸パブリッシャーの設定」ダイアログが表示され、テンプレートを保存してあるフォルダが表示されます。</p>
<p><img src="6_publisher_18.png" width="550" height="435" alt="印刷テンプレートの設定ダイアログ" /><br />
</p>
<p>テンプレートをバックアップする場合は、このフォルダを保存するようにしてください。</p></li>
</ul>
</section>
</section>
</section>
<hr />
<p><a href="#TOP">ページトップ</a>　<a href="hmindex0.html">目次に戻る</a></p>
</body>
</html>
