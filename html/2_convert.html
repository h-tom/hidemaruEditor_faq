<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="Shift_JIS" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="author" content="h-tom" />
  <title>第II部〜知っていると便利な秀丸の機能　変換モジュール</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="base.css" />
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="hmindex0.html"><img src="hide_by2.png" width="88" height="32" alt="Hidemaru Q and A" /></a></p>
<section id="TOP" class="level1">
<h1>第II部〜知っていると便利な秀丸の機能<br>　変換モジュール</h1>
<hr />
<section id="CONVERT" class="level2">
<h2>変換モジュール</h2>
<p>秀丸エディタ Ver.5.00以降では、変換モジュールが使用できます。</p>
<p>変換モジュールは、今まで秀丸エディタ本体で行っていた各種文字変換機能(大文字に変換や小文字に変換等)を、外部プログラムで行えるようにしたものです。標準で添付されているモジュールの他に、<a href="https://hide.maruo.co.jp/lib/hmconv/index.html" class="externallink" target="_blank" rel="noopener">変換モジュールライブラリ</a>にもいくつか登録されています。uniq(重複行削除)もあるので、いろいろ追加しておくと便利です。</p>
<ul>
<li><a href="#EXPLANATION">解説</a>
<ul>
<li><a href="#EXPLANATION-1">変換モジュールの登録方法</a></li>
<li><a href="#EXPLANATION-2">変換モジュールの機能をキー割り当てして使うには</a></li>
<li><a href="#EXPLANATION-3">変換モジュールを置く場所について</a></li>
</ul></li>
<li><a href="#SUPPLEMENTATION">補足</a>
<ul>
<li><a href="#SUPPLEMENTATION-1">64bit対応について</a></li>
<li><a href="#SUPPLEMENTATION-2">「32bit変換モジュールを動作可能にする」について</a></li>
<li><a href="#SUPPLEMENTATION-3">「置換」で使うには</a></li>
<li><a href="#SUPPLEMENTATION-4">変換モジュールを作るには</a></li>
</ul></li>
</ul>
<section id="EXPLANATION" class="level3">
<h3>[解説]</h3>
<p>標準添付されている変換モジュール(HmFilter)には以下の機能があります。</p>
<ul>
<li>UPPER CASE(大文字に変換)</li>
<li>lower case(小文字に変換)</li>
<li>ﾊﾝｶｸ</li>
<li>全角ひらがな</li>
<li>全角カタカナ</li>
<li>TAB -&gt; 空白</li>
<li>空白 -&gt; TAB</li>
<li>英数字/記号/空白のみ半角に</li>
<li>英数字/記号/空白のみ全角に</li>
<li>カタカナのみ半角に</li>
<li>カタカナのみ全角に</li>
<li>インデント</li>
<li>逆インデント</li>
<li>ソート</li>
<li>大文字/小文字の変換</li>
<li>半角/全角変換</li>
</ul>
<p>標準添付以外の変換モジュールを使うには、秀丸エディタに<span class="attention_red">登録する</span>必要があります。</p>
<p>追加する変換モジュール (32bitの場合："*.hmf"、64bitの場合："*.hmf64") は、秀丸エディタ本体と同じ場所(デフォルトだと"C:\Program Files\Hidemaru")に置いてください。<br />
変換モジュールによっては、変換モジュール本体とは別に動作で必要なファイルもあるので、添付されている説明をよく確認してください。</p>
<p>変換モジュールを使うには以下の制限があります。</p>
<ul>
<li>変換モジュール = 外部プログラム で処理を行う都合上、カラーマーカーは破棄されます。
(変換モジュールにはカラーマーカーの情報は渡らない)</li>
<li>変換を行っていなくても、選択した範囲の全行に編集マークが付く。</li>
</ul>
<section id="EXPLANATION-1" class="level4">
<h4>変換モジュールの登録方法</h4>
<p>変換モジュールの登録は、メニューの「その他」-&gt;「<span class="env">動作環境</span>」で行います。</p>
<ol type="1">
<li><p>「<span class="font_red_bold">上級者向け設定</span>」にチェックが付いていない場合、チェックする。</p>
<p><img src="./2_mark_01.png" width="605" height="433" alt="上級者向け設定にチェック" /><br />
</p></li>
<li><p>「編集」の下に項目が追加されるので、「編集」-「<span class="attention_red">変換</span>」を選択する。</p>
<div style="position:relative;">
<p><img src="./HME0084A_01.png" width="613" height="437" alt="動作環境-変換" />
<img src="./2_convert_01.png" width="613" height="437" alt="動作環境-変換-追加" style="position: absolute; left: 0px; top: 0px;"/></p>
</div></li>
<li><p>「<strong>変換モジュール</strong>」に登録済みの変換モジュールが表示されます。(初期状態は"(標準の変換)"のみ)</p>
<p><span class="btn-push">「追加」</span>ボタンで使用したい変換モジュールを指定します。<br />
(秀丸エディタと同じ場所に変換モジュールを置いた場合は、表示されるはず)</p>
<p><img src="./2_convert_02.png" width="650" height="476" alt="選択画面" /><br />
</p></li>
<li><p>「<span class="font_red_bold">使用する変換</span>」に、追加した変換モジュール内の機能が表示されるので、使用する機能にチェックを入れて「OK」を押せば設定が反映されます。</p>
<p><img src="./2_convert_03.png" width="613" height="437" alt="変換モジュールを追加" /><br />
</p></li>
<li><p>秀丸エディタの「編集」メニューの「変換」に4.で追加した機能が表示されます。（変換は<span class="attention_red">範囲選択をした状態</span>でないと、有効になりません）</p>
<p><img src="./2_convert_04.png" width="569" height="658" alt="変換モジュールを追加" /><br />
</p></li>
</ol>
</section>
<section id="EXPLANATION-2" class="level4">
<h4>変換モジュールの機能をキー割り当てして使うには</h4>
<p>「標準の変換モジュール」の場合、「キー割り当て」に対応するコマンド(例えば「ﾊﾝｶｸに変換」等)があります。標準以外の変換モジュールは、対応するコマンドは用意されていません(用意できません)。その為、追加した変換モジュールの機能を、直接「キー割り当て」で指定できません。</p>
<p>追加した変換モジュールの機能を「キー割り当て」で呼び出すには、<br />
<br />
<span class="BoxF">「変換モジュールの機能を呼び出すマクロ」を作り、「キー割り当て」して使う</span><span class="br2"></span>
という方法を使います。</p>
<section id="EXPLANATION-2-1" class="level5">
<h5>変換モジュールの機能を呼び出すマクロを作るには</h5>
<p>変換モジュールを呼び出すには、「<a href="https://help.maruo.co.jp/hidemac/html/080_CmdStatement_Edit_filter.html" class="externallink" target="_blank" rel="noopener">filter文</a>」を使います。</p>
<div class="macro">
<pre><code>filter &quot;変換モジュール名&quot;, &quot;関数名&quot;, &quot;パラメータ(省略可能)&quot;
変換モジュール名: &quot;&quot; を指定した場合は、標準の変換モジュールを使用します。
                  32bit、64bitの違いを考慮し、拡張子(&quot;.hmf&quot; &quot;.hmf64&quot;)は省略可能です。
                  (環境や、設定に合わせ適当に判断される)
                  ただし、変換モジュール名にパスが含まれる場合には、拡張子の省略はできません。
                  必ず指定してください。
関数名          : 呼び出す機能名。
パラメータ      : なければ省略可能です。</code></pre>
</div>
<p>変換モジュールの説明や取説に、使い方があれば、その指示に従います。</p>
<p>使い方等説明がない場合は、「キー操作の記録」を使う方法があります。</p>
<ul>
<li>秀丸エディタのヘルプ−<a href="https://help.maruo.co.jp/hidemaru/html/070_Env_Edit_Convert.html" class="externallink" target="_blank" rel="noopener">編集−変換</a>に 「参考：変換モジュールをキー割り当てする方法」があるので参考にしてください。</li>
</ul>
<p>「キー操作の記録」を使うので、使用する変換モジュールを、あらかじめ秀丸エディタに登録しておく必要があります。</p>
<ol type="1">
<li>範囲選択する。</li>
<li>「マクロ」メニューにある「キー操作の記録開始/終了」で記録開始。</li>
<li>使用したい変換機能を実行する。メニューから「編集 → 変換 → 使用する変換機能」を選択。</li>
<li>「マクロ」メニューにある「キー操作の記録開始/終了」で記録停止。</li>
<li>「マクロ」メニューにある「キー操作の保存」でファイルに保存する。</li>
</ol>
<p>これが、実際にソート(昇順、数値の大小でソート)し、保存したファイルです。
(標準の変換モジュールを使用しているので、変換モジュール名は省略されています)</p>
<div class="macro">
<pre><code>setcompatiblemode 0x0F;
filter &quot;&quot; , &quot;Sort&quot; , &quot;000100010001000\&quot;00&quot;;</code></pre>
</div>
<p>そのまま使っても良いのですが、範囲選択しているかどうかのチェックを追加します。
(範囲選択していなければ失敗するだけなので、チェックが必須という事はないです)</p>
<div class="macro">
<pre><code>setcompatiblemode 0x0F;
if(!selecting){
    message &quot;範囲選択してから実行してください。&quot;;
    endmacro;
}
filter &quot;&quot; , &quot;Sort&quot; , &quot;000100010001000\&quot;00&quot;;
endmacro;</code></pre>
</div>
<p>このマクロファイルを、「<a href="./3_macro.html">秀丸マクロのいろはにほへと</a>」の「<a href="./3_macro.html#REGIST">【４】マクロ登録</a>」、「<a href="./3_macro.html#SHORTCUT">【５】ショートカットキーへの登録</a>」を参考に、マクロを登録し、キーに割り当ててください。</p>
<p>複数選択状態で、マクロを実行する場合は注意が必要です。</p>
<p>デフォルト状態では、filter文は「複数選択」に対応していません。たとえば複数選択状態で実行しても、複数選択した箇所全てではなく、カーソルのある箇所だけ実行されます。</p>
<p>各種命令を「複数選択」に対応させるには、「<span class="font_red">setcompatiblemode</span>文」を使います。</p>
<p>setcompatiblemode 文のフラグには、以下のフラグがあります。</p>
<div class="macro">
<pre><code>0x00100000 各種の文を複数選択に対応した動作へ設定。</code></pre>
</div>
<p>setcompatiblemode文 にこのフラグをセットしてマクロに追加しておけば、複数選択に対応させることが可能です。</p>
</section>
</section>
<section id="EXPLANATION-3" class="level4">
<h4>変換モジュールを置く場所について</h4>
<p>説明では秀丸エディタ本体と同じ場所に置きましたが、実際は何処に置いても登録してしまえば、秀丸エディタ本体からは問題なく使用できます。</p>
<p>問題(というかチョット面倒?)になるのは、マクロが絡む場合です。</p>
<p>「キー操作の記録」を使う場合、変換モジュールの登録は必要ですが、マクロから変換モジュールを呼び出すだけなら登録は不要です。その為、「キー操作の記録」を使わずにマクロを作成する場合、変換モジュール名の記述方法に注意が必要です。</p>
<ul>
<li><p>秀丸エディタ本体と同じ場所に配置した場合</p>
<div class="macro">
<pre><code>filter &quot;HmFilter&quot; , &quot;Sort&quot; , &quot;〜&quot;</code></pre>
</div>
<p>のように、変換モジュール名を指定すればいい。拡張子が無くても、設定や環境に合わせ、適当に判断されます。
(秀丸エディタと同じ場所に変換モジュールを置いても、モジュール名の指定にパスが含まれると、拡張子の省略はできません)</p></li>
<li><p>秀丸エディタ本体とは別に配置した場合</p>
<div class="macro">
<pre><code>filter &quot;C:\\macro\\module\\HmFilter.hmf&quot; , &quot;Sort&quot; , &quot;〜&quot;</code></pre>
</div>
<p>のように、変換モジュール名にフルパスを指定しないと、秀丸エディタが変換モジュールを読み込めません。
(拡張子の省略はできないので、必ず指定してください)</p></li>
</ul>
<p>秀丸エディタ本体とは別に配置した場合、「キー操作の記録」を行うと変換モジュール名はフルパス(拡張子付き)で記録されるので、「キー操作の記録」を使って雛形のマクロを作る方法をお勧めします。</p>
</section>
</section>
<section id="SUPPLEMENTATION" class="level3">
<h3>[補足]</h3>
<section id="SUPPLEMENTATION-1" class="level4">
<h4>64bit対応について</h4>
<p>変換モジュールは、実行環境により以下の拡張子で識別されます。</p>
<ul>
<li>32bit用変換モジュールは"*.hmf"</li>
<li>64bit用変換モジュールは"*.hmf64"</li>
</ul>
<p>通常、秀丸エディタ本体と同じbit数の変換モジュールしか使えませんが、
64bit版秀丸エディタは設定により32bit用変換モジュールを使用できます。
(逆の32bit版秀丸エディタで、64bit変換モジュールを使う事は出来ません)</p>
<p>64bit版秀丸エディタだけにある、「<span class="env">動作環境</span>」-「64bit版」-「32bit版との互換性」の<strong>「32bit変換モジュール(*.hmf)を動作可能にする」</strong>のチェックを ON にしてください。これで、64bit版秀丸エディタで、32bit版変換モジュールが使用可能になります。
(ただし、32bit版変換モジュールが<span class="attention_red">正常に動作する保証はありません。</span>)</p>
<p><img src="2_convert_06.png" width="613" height="433" alt="32bit版の互換性" /><br />
</p>
</section>
<section id="SUPPLEMENTATION-2" class="level4">
<h4>「32bit変換モジュールを動作可能にする」について</h4>
<ul>
<li><p>秀丸エディタ本体で変換モジュールを使う場合</p>
<p>32bit用変換モジュールを登録してある場合、チェックを「<span class="attention_red">OFF</span>」にすると、変換メニューに表示されなくなり、使用できなくなります。</p></li>
<li><p>マクロや置換から使用する場合</p>
<p>64bit/32bit版両方の変換モジュールがあり、拡張子が省略されていた場合は、チェックが「<span class="attention_red">ON</span>」でも64bit版が優先的に使用されます。</p>
<p>拡張子が指定されていた場合は、指定されたモジュールを読み込みます。チェックが「<span class="attention_red">OFF</span>」の状態で、32bit版変換モジュールを指定すると、実行に失敗します。(変換自体行われない)</p></li>
</ul>
</section>
<section id="SUPPLEMENTATION-3" class="level4">
<h4>「置換」で使うには</h4>
<p>秀丸エディタ Ver.8.13より、置換する内容を指定するかわりに変換モジュールの機能を指定できるようになりました。</p>
<p>これで何ができるかというと、検索でマッチした箇所を、大文字/小文字/全角/半角へ等に変換する事が可能になります。
(検索でマッチした範囲に対し、指定された変換モジュールを使い変換する)</p>
<p>詳細は、「<a href="./hmindex2.html">知っていると便利な秀丸の機能</a>」の「<a href="./2_replace.html">●置換</a>」にある、
<a href="./2_replace.html#SUPPLEMENTATION-3">[変換モジュールを使った置換]</a>を参照してください。</p>
<p>ただし、使用する変換モジュールが秀丸エディタ本体と同じ場所にない場合、マクロと同じくモジュール名にフルパスを指定する必要があります。</p>
</section>
<section id="SUPPLEMENTATION-4" class="level4">
<h4>変換モジュールを作るには</h4>
<p>変換モジュールの実体はDLLなので、自分で作ることも可能です。</p>
<p><a href="https://hide.maruo.co.jp/software/hidemaru.html" class="externallink" target="_blank" rel="noopener">秀丸エディタ</a>のダウンロードに、「変換モジュール開発キットおよびサンプル変換モジュール」があるので、参考にしてください。</p>
</section>
</section>
</section>
</section>
<hr />
<p><a href="#TOP">ページトップ</a>　<a href="hmindex0.html">目次に戻る</a></p>
</body>
</html>
