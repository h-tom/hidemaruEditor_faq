<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="Shift_JIS" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="author" content="h-tom" />
  <title>第II部〜知っていると便利な秀丸の機能　ファイルマネージャ枠</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="base.css" />
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="./hmindex0.html"><img src="./hide_by2.png" width="88" height="32" alt="Hidemaru Q and A" /></a></p>
<section id="TOP" class="level1">
<h1>第II部〜知っていると便利な秀丸の機能<br>　ファイルマネージャ枠</h1>
<hr />
<section id="CONVERT" class="level2">
<h2>ファイルマネージャ枠</h2>
<p>秀丸エディタ Ver.8.00以降ではファイルマネージャ枠が使用できます。</p>
<p>ファイルマネージャ枠は、名前の通りファイル/フォルダの一覧を表示するための枠です。</p>
<p>メニューの「表示」からファイルマネージャ枠の表示の切り替えが可能です。</p>
<p><img src="./2_filemanager_01.png" width="373" height="310" alt="メニュー-表示" /><br />
</p>
<ul>
<li><a href="#EXPLANATION">解説</a>
<ul>
<li><a href="#EXPLANATION-1">フォルダ/ファイル/フォルダ+ファイル一覧</a></li>
<li><a href="#EXPLANATION-2">ヒストリ</a></li>
<li><a href="#EXPLANATION-3">ウィンドウ一覧</a></li>
<li><a href="#EXPLANATION-4">ブックマーク</a></li>
<li><a href="#EXPLANATION-5">プロジェクト</a></li>
</ul></li>
<li><a href="#SUPPLEMENTATION">補足</a>
<ul>
<li><a href="#SUPPLEMENTATION-1">フォルダ/ファイル/フォルダ+ファイル一覧 について</a></li>
<li><a href="#SUPPLEMENTATION-2">プロジェクトについて</a></li>
</ul></li>
</ul>
<section id="EXPLANATION" class="level3">
<h3>[解説]</h3>
<p>ファイルマネージャ枠には以下の内容が表示可能です。</p>
<dl>
<dt><a href="#EXPLANATION-1">フォルダの一覧</a></dt>
<dd>
フォルダーツリーです。フォルダを選択するとファイル一覧に切り替わります。
</dd>
<dt><a href="#EXPLANATION-1">ファイルの一覧</a></dt>
<dd>
選択したフォルダのファイル一覧です。
</dd>
<dt><a href="#EXPLANATION-1">フォルダ+ファイルの一覧</a></dt>
<dd>
上にフォルダーツリー、下にファイル一覧が表示されます。
</dd>
<dt><a href="#EXPLANATION-2">ヒストリ</a></dt>
<dd>
秀丸エディタで開いたファイルの履歴一覧。
</dd>
<dt><a href="#EXPLANATION-3">ウィンドウ一覧</a></dt>
<dd>
秀丸エディタで、現状開いているファイルの一覧。タブモードの場合はタブ毎に表示されます。
</dd>
<dt><a href="#EXPLANATION-4">ブックマーク</a></dt>
<dd>
webブラウザにある、よく使うファイルの一覧。
</dd>
<dt><a href="#EXPLANATION-5">プロジェクト</a></dt>
<dd>
ブックマークと同様、必要なファイルをまとめた一覧。切り替え可能なブックマークみたいな物です。
</dd>
</dl>
<p>ツールバーの表示項目部分が「ボタン」になっていて、左クリックで切り替えメニューが表示されます。</p>
<p><img src="./2_filemanager_06.png" width="232" height="274" alt="ファイルマネージャ枠のメニュー" /><br />
</p>
<p>ツールバーやファイルマネージャ枠内で右クリックするか、ツールバーの▼部分を左クリックすると各種設定込みの切り替えメニューが表示されます。
(切り替え以降のメニュー項目は、表示している内容によって切り替わります)</p>
<p><img src="./2_filemanager_02.png" width="356" height="468" alt="ファイルマネージャ枠のメニュー" /><br />
</p>
<section id="EXPLANATION-1" class="level4">
<h4>フォルダ/ファイル/フォルダ+ファイル一覧</h4>
<p>その名の通り、以下の内容を表示する枠です。</p>
<ul>
<li>フォルダの一覧</li>
<li>ファイルの一覧</li>
<li>フォルダ+ファイルの一覧</li>
</ul>
<p><strong>「フォルダの一覧」</strong>は、エクスプローラのフォルダツリー部分のみのと同じです。フォルダを選択する(ダブルクリック or Enterキー押下)と、「ファイル一覧」に切り替わります。</p>
<p><strong>「ファイルの一覧」</strong>は、選択されたフォルダにあるファイルの一覧を表示します。設定により、「サブフォルダ」を表示する/しない を切り替える事が出来ます。ファイルを選択する(ダブルクリック or Enterキー押下)と、ファイルの種類に関係なく、秀丸エディタで開きます。その為、テキストファイルでないファイルも秀丸エディタで開きます。</p>
<hr />
<p><span class="attention_red">注意</span></p>
<ul>
<li><p>ヘルプに以下の記述があります。</p>
<pre><code>「あくまで秀丸エディタ用の簡易的なものとして使っていただくためのものです。
本当のファイル操作などはWindowsエクスプローラでされることをお勧めします。」</code></pre></li>
<li><p>Windowsエクスプローラのようにフォルダ構成が変化したときの自動反映は実装されていません。変化があった場合、「最新の情報に更新」（枠内でF5キー）をしてもらう必要があります。</p></li>
</ul>
<hr />
<p>ファイルマネージャ枠の右クリックメニューにある「詳細」を選ぶと、ファイルマネージャ枠の設定画面が開きます。</p>
<p>「一般」はファイルマネージャ枠の表示に関する設定です。</p>
<p><img src="./2_filemanager_03.png" width="496" height="453" alt="ファイルマネージャ枠の詳細-一般" /><br />
</p>
<ul>
<li>「表示する」「自動で覚える」は表示状態に関する設定で、表示をする/しない と、表示状態を覚えておき自動で設定するかどうかになります。</li>
<li>「初期フォルダ」は最初に表示するフォルダの位置を指定します。「デスクトップ」にしておくと、起動が速くなります。</li>
<li>表示位置、フォント、色などは好みに応じて設定してください。</li>
</ul>
<hr />
<p>「フォルダ/ファイル一覧」はフォルダ/ファイル一覧 表示に関する設定です。</p>
<p><img src="./2_filemanager_04.png" width="496" height="453" alt="ファイルマネージャ枠の詳細-フォルダ/ファイル一覧" /><br />
</p>
<ul>
<li><p><strong>フォルダモードの「ファイル表示」は</strong>、フォルダーツリーにフォルダだけではなく、<span class="attention_red">ファイルを表示する</span>為の設定になります。</p>
<p><img src="./2_filemanager_05.png" width="320" height="270" alt="ファイルマネージャ枠の詳細-フォルダのファイル表示" /><br />
</p>
<p>「カスタム」で表示する拡張子を指定できます。「すべて」だと、ファイル数が多いと時間がかかる事もあります。</p>
<p>「既定のワイルドカード」の場合は、「その他」→「<span class="env">動作環境</span>」→「ファイル」→「最初のワイルドカード」と同じになります。</p></li>
<li><p>ファイルモードの「ファイル表示」は、ファイル一覧の表示設定です。</p>
<p>「既定のワイルドカード」の場合は、「その他」→「<span class="env">動作環境</span>」→「ファイル」→「最初のワイルドカード」と同じになります。</p>
<p>「カスタム」で表示する拡張子を指定できます。複数の拡張子を指定する場合は、
"<code>;</code>" で区切って入力してください。</p>
<pre><code>例)*.txt;*.html</code></pre></li>
</ul>
</section>
<section id="EXPLANATION-2" class="level4">
<h4>ヒストリ</h4>
<p>秀丸エディタ本体にあるファイルヒストリと同じです。メニューで表示するか枠内に常時表示するかの違いです。</p>
<p>右クリックメニューから選択したヒストリの削除が可能です。</p>
</section>
<section id="EXPLANATION-3" class="level4">
<h4>ウィンドウ一覧</h4>
<p>秀丸エディタ本体にあるウィンドウ一覧と同じです。ウィンドウで表示するか枠内に常時表示するかの違いです。</p>
<p>右クリックメニューから選択したウィンドウを閉じる事が可能です。</p>
</section>
<section id="EXPLANATION-4" class="level4">
<h4>ブックマーク</h4>
<p>秀丸エディタ本体にあるブックマークと同じです。メニューで表示するか枠内に常時表示するかの違いです。</p>
<p>右クリックメニューからブックマークの操作(追加/削除/上/下)が可能です。</p>
<p>「追加」を行うと以下の画面が表示されます。</p>
<p><img src="./2_filemanager_09.png" width="378" height="284" alt="ブックマーク" /><br />
</p>
<p>「ファイル」はファイルを、「グループ」は分類用のフォルダを、「セパレータ」は区切り線を追加します。</p>
<p>「フォルダ内のファイル一覧」は、グループを作成し指定された拡張子のファイルを自動的に追加します。</p>
</section>
<section id="EXPLANATION-5" class="level4">
<h4>プロジェクト</h4>
<p>ブックマークと同様、必要なファイルをまとめた一覧です。場合によって切り替えるブックマークみたいな物です。</p>
<p>右クリックメニューからプロジェクトの操作(開く/上書き/名前を付けて保存/追加/削除/上/下)が可能です。<br />
「追加」を行うとブックマークと同じ画面が開きます。</p>
<p><img src="./2_filemanager_11.png" width="342" height="474" alt="プロジェクト右クリックメニュー" /><br />
</p>
<p>ブックマークと違うのは、変更したときは「名前を付けて保存」する必要がある事と、複数のプロジェクトファイルを使い分ける事ができる事です。</p>
<p><img src="./2_filemanager_10.png" width="217" height="112" alt="ファイルマネージャ枠の詳細-プロジェクト" /><br />
</p>
<p>設定でプロジェクトを編集した場合に直ぐに保存するようできますが、名前を付けていない場合(デフォルト状態)では無視されます。</p>
<p><img src="./2_filemanager_07.png" width="496" height="237" alt="ファイルマネージャ枠の詳細-ブックマーク/プロジェクト" /><br />
</p>
</section>
</section>
<section id="SUPPLEMENTATION" class="level3">
<h3>[補足]</h3>
<section id="SUPPLEMENTATION-1" class="level4">
<h4>フォルダ/ファイル/フォルダ+ファイル一覧 について</h4>
<p>「フォルダ/ファイル/フォルダ+ファイル一覧」は、現在編集中のファイルの場所とは、リンクしていません。その為、ファイル(タブやウィンドウ)を切り替えても自動的に場所が切り替わる事はありません。</p>
<p>現在編集のファイルがある場所を開きたい場合は、明示的に「同期」コマンドを実行する必要があります。</p>
<p>自動起動マクロに「アクティブ切り替え後」があるので、マクロから「同期」コマンドを実行するようにすれば自動的に同期させることが可能です。</p>
<p>ファイルマネージャ枠の同期を行うマクロの例です。</p>
<p>以下のマクロを「アクティブ切り替え後」に指定しておけば、ファイルを切り替時にファイルマネージャ枠も変更されます。</p>
<p>自動起動マクロに関しては、「<a href="./3_autostartmacro.html">第III部〜秀丸マクロのいろはにほへと　自動起動マクロ</a>」を参照してください。</p>
<pre class="macro"><code>//DLLのロードを実行
#HmExplorer = loaddll(&quot;HmExplorerPane.dll&quot;);
//DLLのロードに失敗した場合は終了
if(#HmExplorer == 0) endmacro;
//枠のハンドルを取得
#fm = dllfunc(#HmExplorer, &quot;GetWindowHandle&quot;, hidemaruhandle(0));
//枠があるか確認(枠がない場合、&quot;GetWindowHandle&quot; は ゼロを返す)
if(#fm &gt; 0){
    //表示モードを確認(6 フォルダ+ファイル一覧モード,0 フォルダモード,1 ファイル一覧モード)
    #mode = dllfunc(#HmExplorer, &quot;GetMode&quot;,hidemaruhandle(0));
    //表示モードがファイル関連なら、同期コマンド呼び出し
    if(#mode == 6 || #mode == 0 || #mode == 1){
        //同期実行
        #ret = sendmessage(#fm ,0x111/*WM_COMMAND*/, 252 ,0); //252=同期
    }
}
freedll #HmExplorer;
endmacro;</code></pre>
</section>
<section id="SUPPLEMENTATION-2" class="level4">
<h4>プロジェクトについて</h4>
<p>プロジェクトはファイルを一個ずつしか登録できません。「フォルダ内のファイル一覧」を使えば、拡張子を指定してまとめて追加できますが、不要なファイルまで含まれる場合もあります。</p>
<p>プロジェクトファイルの構造は簡単なので、登録するファイルが多い場合はフルパスのファイルリストを作り、そこから編集した方が早い場合もあります。</p>
<p>ファイル構造はブックマークと同じです。秀丸エディタヘルプ-<a href="https://help.maruo.co.jp/hidemaru/html/070_Env_Bookmark_Dlg.html" class="externallink" target="_blank" rel="noopener">ブックマークの整理</a>の内容と、実際のプロジェクトファイルを開いてみてください。</p>
</section>
</section>
</section>
</section>
<hr />
<p><a href="#TOP">ページトップ</a>　<a href="hmindex0.html">目次に戻る</a></p>
</body>
</html>
