<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="Shift_JIS" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="author" content="h-tom" />
  <title>第II部〜知っていると便利な秀丸の機能　縦書き</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="base.css" />
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="hmindex0.html"><img src="hide_by2.png" width="88" height="32" alt="Hidemaru Q and A" /></a></p>
<section id="TOP" class="level1">
<h1>第II部〜知っていると便利な秀丸の機能<br>　縦書き</h1>
<hr />
<section id="VERTICAL" class="level2">
<h2>縦書き</h2>
<p>秀丸エディタ Ver.5.00以降では、「縦書き」ができます。</p>
<ul>
<li><a href="#EXPLANATION">解説</a>
<ul>
<li><a href="#EXPLANATION-1">設定</a></li>
<li><a href="#EXPLANATION-2">印刷</a></li>
</ul></li>
<li><a href="#SUPPLEMENTATION">補足</a></li>
</ul>
<section id="EXPLANATION" class="level3">
<h3>[解説]</h3>
<p>「縦書き」は、<strong>現状の設定を一時的に縦書きにする方法</strong>と、縦書き用の「<span class="filetype">ファイルタイプ別の設定</span>」を作る方法があります。</p>
<p>縦書き用にフォント 行間 文字間等細かい箇所まで設定したい場合は、「<span class="filetype">ファイルタイプ別の設定</span>」を作るのがいいでしょう。</p>
<p>「<span class="filetype">ファイルタイプ別の設定</span>」は拡張子と関連付ける必要があります。全てのテキストファイルを縦書きにするなら、".txt" と「縦書き用設定」を関連付けすればいいのですが、そうでない場合は、縦書き用の拡張子を別途決めて関連付けしてください。</p>
<ul>
<li><p>一時的に縦書きにする方法</p>
<p>メニューの「表示」から「縦書きモード」を選択すると、現状の「<span class="filetype">ファイルタイプ別の設定</span>」で、「縦書き」を有効にした状態となります。</p></li>
</ul>
<section id="EXPLANATION-1" class="level4">
<h4>設定</h4>
<p>「縦書き」の設定は、「<span class="filetype">ファイルタイプ別の設定</span>」で行います。</p>
<p><img src="2_vertical_01.png" width="428" height="288" alt="縦書きの設定" /><br />
</p>
<ul>
<li><p>「体裁」-「詳細」の「縦書き」にチェックを入れると縦書きになり、<span class="btn-push">「詳細」</span>ボタンが有効になります。</p></li>
<li><p>「一時的な縦書き」になっている場合は、チェックの状態が通常と異なります。</p>
<p><img src="2_vertical_03.png" width="89" height="24" alt="一時的な縦書きの設定" /><br />
</p>
<p>この「一時的な縦書き」状態で「<span class="filetype">ファイルタイプ別の設定</span>」を操作・保存しても、<strong>「縦書き」の状態は保存されません。</strong>
(「縦書き」以外の変更内容は保存されます)</p>
<p><strong>ただし、「縦書き」を操作してしまうと「一時的な縦書き」状態が解除されてしまい、ON/OFF状態が保存されます。</strong></p></li>
</ul>
<p><span class="btn-push">「詳細」</span>ボタンを押すと、ダイアログが表示され細かい設定も可能になっています。必要に応じて設定してください。通常、縦書きになるのは全角文字だけですが、半角文字も対象にしたり半角数字を漢数字に変換して表示できます。</p>
<p><img src="2_vertical_02.png" width="447" height="440" alt="縦書きの詳細" /><br />
</p>
<ul>
<li>横書きの元データ<br />
<img src="2_vertical_11.png" width="217" height="124" alt="横書きの元データ" /><br />
</li>
</ul>
<div class="flex-container">
<ul>
<li><p>全部OFF<br />
<img src="2_vertical_12.png" width="139" height="234" alt="縦書き状態" /><br />
</p></li>
<li><p>&#9745;行番号も縦書き<br />
<img src="2_vertical_13.png" width="139" height="234" alt="縦書き、行番号も縦書き状態" /><br />
</p></li>
<li><p>&#9745;半角も縦書き<br />
<img src="2_vertical_14.png" width="139" height="234" alt="縦書き、半角も縦書き状態" /><br />
</p></li>
</ul>
</div>
<div class="flex-container">
<ul>
<li><p>&#9745;縦中横<br />
<img src="2_vertical_15.png" width="139" height="234" alt="縦書き、縦中横状態" /><br />
</p></li>
<li><p>&#9745;半角も縦書き &#9745;半角漢数字<br />
<img src="2_vertical_16.png" width="139" height="234" alt="縦書き、半角、半角漢数字状態" /><br />
</p></li>
</ul>
</div>
</section>
<section id="EXPLANATION-2" class="level4">
<h4>印刷</h4>
<p>秀丸エディタから縦書きで印刷したい場合は、「秀丸パブリッシャー」が必要です。</p>
<p>「秀丸パブリッシャー」の詳細は、「<a href="6_publisher.html">第VI部〜秀丸エディタ拡張モジュール　秀丸パブリッシャー</a>」を参照してください。</p>
<p>テンプレートの「本文BOX」-「縦書き」設定で、縦書きモードが「秀丸エディタと同じ」であれば、秀丸エディタ本体側の横書き・縦書きの状態が反映されます。</p>
<p><img src="2_vertical_21.png" width="295" height="175" alt="秀丸パブリッシャー−秀丸エディタと同じ" /><br />
</p>
</section>
</section>
<section id="SUPPLEMENTATION" class="level3">
<h3>[補足]</h3>
<section id="縦書きが変な場合" class="level4">
<h4>縦書きが変な場合</h4>
<ul>
<li>フォントを変えてみましょう。</li>
<li>「<span class="env">動作環境</span>」-「表示/操作」-「文字の描画」にある「3Dグラフィックスアクセラレータによる文字の描画」を有効にすれば改善するかもしれません。ただし、縦書きの場合は Windows 10 以降が必要です。(Windows 7、8、8.1では縦書き時は無効)</li>
</ul>
</section>
<section id="SUPPLEMENTATION-2" class="level4">
<h4>マクロで縦書き用の設定に切り替える方法</h4>
<p>マクロを使えば、一時的な縦書きにしたり、拡張子に関連付けしなくても縦書き用の「<span class="filetype">ファイルタイプ別の設定</span>」へ切り替える事ができます。</p>
<section id="SUPPLEMENTATION-2-1" class="level5">
<h5>マクロの例1</h5>
<p>ファイルの先頭に縦書きであることを示す文字列がある場合、縦書き用の「<span class="filetype">ファイルタイプ別の設定</span>」を設定します。</p>
<ul>
<li>条件
<ul>
<li>対象の拡張子は、".txt"のみ。</li>
<li>縦書き用の「<span class="filetype">ファイルタイプ別の設定</span>」をあらかじめ作っておくこと。</li>
<li>ファイルの先頭に縦書きであることを示す文字列を入れておく。(例では"[tategaki]"という文字列)</li>
</ul></li>
<li>制限
<ul>
<li>「<span class="filetype">ファイルタイプ別の設定</span>」が一時的なものになる。</li>
</ul></li>
</ul>
<div class="macro">
<pre><code>//縦書き用の設定名
$FileTypeName = &quot;縦書き&quot;;
//縦書き識別用の文字列
$SearchString = &quot;[tategaki]&quot;;

//テキストファイルか確認
if(filetype == &quot;.txt&quot;){
    //取り込む文字数の設定
    #len  = 255;
    //先頭行を取り込む
    $CheckString = gettext(0, 0, #len, 0, 0, 0);
    
    //識別用文字列があるか確認
    //指定文字が含まれる場合
    if(strstr($CheckString, $SearchString) &gt; -1){
        //設定を切り替える
        configset $FileTypeName;
    }
}
endmacro;</code></pre>
</div>
</section>
<section id="SUPPLEMENTATION-2-2" class="level5">
<h5>マクロの例2</h5>
<p>ファイルが特定のフォルダ以下にある場合、縦書き用の「<span class="filetype">ファイルタイプ別の設定</span>」を設定します。</p>
<ul>
<li>条件
<ul>
<li>対象の拡張子は、".txt"のみ。</li>
<li>縦書き用の「<span class="filetype">ファイルタイプ別の設定</span>」をあらかじめ作っておくこと。</li>
<li>縦書きのファイルがあるフォルダを指定する。</li>
</ul></li>
<li>制限
<ul>
<li>「<span class="filetype">ファイルタイプ別の設定</span>」が一時的なものになる。</li>
</ul></li>
</ul>
<div class="macro">
<pre><code>//縦書き用の設定名
$FileTypeName = &quot;縦書き&quot;;
//縦書き用のフォルダを指定する
$SearchString = @&quot;C:\tategaki&quot;;

//テキストファイルか確認
if(filetype == &quot;.txt&quot;){
    
    //ファイルに指定されたパスが含まれるかチェックする
    if(strstr(directory, tolower($SearchString)) == 0){
        //設定を切り替える
        configset $FileTypeName;
    }
}
endmacro;</code></pre>
</div>
</section>
<section id="SUPPLEMENTATION-2-3" class="level5">
<h5>マクロの例3</h5>
<p>一時的な縦書きにする場合は、上記2つのマクロの一部を変更します。</p>
<ul>
<li><p>修正前</p>
<div class="macro">
<pre><code>//設定を切り替える
configset $FileTypeName;</code></pre>
</div></li>
<li><p>修正後</p>
<div class="macro">
<pre><code>//一時的に縦書きへ変更する
#main = hidemaruhandle(0);
#WM_COMMAND = 0x0111;
#tategaki_switch = 341;
#n = sendmessage(#main, #WM_COMMAND, #tategaki_switch, 0);</code></pre>
</div></li>
</ul>
</section>
</section>
</section>
</section>
</section>
<hr />
<p><a href="#TOP">ページトップ</a>　<a href="hmindex0.html">目次に戻る</a></p>
</body>
</html>
