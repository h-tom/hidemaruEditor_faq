<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="Shift_JIS" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="author" content="h-tom" />
  <title>第II部〜知っていると便利な秀丸の機能　デスクトップ保存と復元</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="base.css" />
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="hmindex0.html"><img src="hide_by2.png" width="88" height="32" alt="Hidemaru Q and A" /></a></p>
<section id="TOP" class="level1">
<h1>第II部〜知っていると便利な秀丸の機能<br>　デスクトップ保存と復元</h1>
<hr />
<section id="FUZZY" class="level2">
<h2>「デスクトップ保存」と「デスクトップ復元」について</h2>
<p>「デスクトップ保存」/「デスクトップ復元」は、秀丸エディタで開いているファイルのウィンドウサイズと位置を保存・復元します。</p>
<p>Ver.8未満では、「デスクトップ保存/復元」は1つしか保存できませんでした。<br />
Ver.8以降は「名前をつけてデスクトップを保存」も可能になり、複数の状態を保存できます。</p>
<ul>
<li><a href="#EXPLANATION">解説</a></li>
</ul>
<section id="EXPLANATION" class="level3">
<h3>[解説]</h3>
<ul>
<li><p>「デスクトップ保存」は、デフォルトでは以下の場所から実行できます。</p>
<ul>
<li>「ウィンドウ」メニュー。</li>
<li>「全終了」「全保存終了」を実行した時に自動保存(<strong>要設定</strong>)。</li>
</ul>
<p>「デスクトップ保存」は、以下のウィンドウ(タブ)は対象外です。</p>
<ul>
<li>無題の秀丸エディタ</li>
<li>「webブラウズモード」「grepの結果」「プログラムの実行結果」</li>
<li>ファイル名はついているけど保存していないファイル</li>
</ul>
<p>保存される情報は、基本的にはウィンドウの<strong>「サイズ」と「位置」</strong>です。ウィンドウの分割状態やIMEの状態、アクティブなウィンドウ(タブ)など、保存しない状態もあります。</p>
<p>設定で有効にすれば、以下の内容も保存できます。</p>
<ul>
<li><p>Windows 10の仮想デスクトップ</p></li>
<li><p>カーソルある<span class="attention_red">行</span></p>
<p>設定がOFFでも、以下の条件がそろえばカーソル位置は復元されます。</p>
<ul>
<li>「ファイルタイプ別の設定」にある「カーソル位置の自動復元」が有効になっている。</li>
<li>ファイルヒストリに対象のファイルが残っている。</li>
</ul></li>
</ul></li>
<li><p>「名前をつけてデスクトップを保存」は、「ウィンドウ」メニューから実行しますが、デフォルトでは表示されていません。その場合は以下の手順で表示させてください。</p>
<ol type="1">
<li>メニューの「その他」-「メニュー編集」から「メニュー編集ダイアログ」を開く。</li>
<li>「メニューバー」を選び、「ウィンドウ」を選択。</li>
<li>「メニュー内のコマンド」内の、「名前をつけてデスクトップを保存」と「デスクトップを開く」にチェックをします。</li>
<li>「OK」を押してダイアログを閉じます。</li>
</ol></li>
<li><p>「デスクトップ復元」は、デフォルトでは以下の箇所から実行できます。</p>
<ul>
<li><p>「ウィンドウ」メニュー</p></li>
<li><p>「常駐秀丸」の右クリックメニュー</p></li>
<li><p>「起動オプション」<br />
起動オプションの使い方は「<a href="4_cmdlin.html">第IV部〜テキスト編集を極める！！　起動オプションを使ってみよう</a>」を参照してください。</p>
<p>オプションは「/e」または、「/e:保存したデスクトップのフルパス」になります。</p></li>
</ul>
<p>復元する場合、現在開いている秀丸エディタがあると閉じようとするので、必要に応じて保存してください。</p></li>
<li><p>「デスクトップを開く」は、「ウィンドウ」メニューから実行しますが、デフォルトでは表示されません。「名前をつけてデスクトップを保存」と同じ方法でメニューに表示させてください。</p></li>
<li><p>「デスクトップ保存」/「デスクトップ復元」の設定</p>
<p>設定は「<span class="env">動作環境</span>」-「ウィンドウ」-「デスクトップ保存」で行います。</p>
<p><img src="2_desktop_01.png" width="541" height="190" alt="デスクトップ保存の設定" /><br />
</p>
<div class="mark_dt">
<dl>
<dt>全終了時にいっしょにデスクトップ保存を実行する</dt>
<dd>
「全終了」または「全保存終了」を実行した場合、自動的に「デスクトップ保存」を行います。
</dd>
<dt>タブモードでウィンドウを閉じるときにも適用</dt>
<dd>
ONにする場合は、タブモードの詳細で「ウィンドウ右上の閉じるボタンでタブを全て閉じる」も、ONにしてください。
</dd>
<dt>新規に秀丸エディタを起動するとき自動でデスクトップ復元する</dt>
<dd>
ほかの秀丸エディタがいない状態で、新規に秀丸エディタを起動した場合、デスクトップ復元を自動的に行います。常駐秀丸から起動する場合や、既に他の秀丸エディタが起動していた場合は無効です。
</dd>
<dt>全ての仮想デスクトップを保存/復元する</dt>
<dd>
Windows 10の仮想デスクトップにある状態も保存します。チェックしない場合は、現在のデスクトップだけ対象になります。
</dd>
<dt>カーソル行の位置を保存/復元する</dt>
<dd>
カーソルの行位置も保存/復元します。
OFFの場合は、「ファイルタイプ別の設定」にある「カーソル位置の自動復元」によります。
</dd>
</dl>
</div></li>
</ul>
</section>
</section>
</section>
<hr />
<p><a href="#TOP">ページトップ</a>　<a href="hmindex0.html">目次に戻る</a></p>
</body>
</html>
