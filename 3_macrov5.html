<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="Shift_JIS" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第III部〜秀丸マクロのいろはにほへと　秀丸エディタVer.5.00 マクロ関連の変更履歴</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="base.css" />
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="hmindex0.html"><img src="hide_by2.png" width="88" height="32" alt="Hidemaru Q and A" /></a></p>
<h1 id="TOP">第III部〜秀丸マクロのいろはにほへと<br>　秀丸エディタVer.5.00 マクロ関連の変更履歴</h1>
<hr />
<h2 id="V5">秀丸エディタVer.5.00 マクロ関連の変更履歴</h2>
<p>【１】<a href="#LIST">マクロ関連の変更履歴 - 「秀丸エディタ」Ver. 5.00</a><br />
【２】<a href="#spec">仕様変更</a><br />
</p>
<!-- h3 -->
<div class="marginleft">
<h3 id="LIST">【１】マクロ関連の変更履歴 - 「秀丸エディタ」Ver.5.00</h3>
<ul>
<li>nexttab追加</li>
<li>prevtab追加</li>
<li>filter追加</li>
<li>searchoption, setsearchのビット11,12</li>
<li>hilightfound 追加</li>
<li>columnとlinenoで指定する関連のいろいろ追加
<ul>
<li>gettext2, columntox, linenotoy, xtocolumn, ytolineno</li>
<li>seltopcolumn, seltoplineno, selendcolumn, selendlineno</li>
</ul></li>
<li>config "x…"で指定できるものに xImeColorCurLine を追加</li>
<li>config "x…"で指定できるものに xTategaki とxDangumiを追加</li>
<li>config "x…"で指定できるものに xLastColor, xStripe, xClistFont, xClistFontSize を追加</li>
<li>searchdown等のオプションに hilight nohilight を追加</li>
<li>config "x…"で指定できるものに xCharSpace を追加</li>
<li>foundhilightingキーワード追加</li>
<li>nexttab/prevtabでマクロの実行が移らなかったのを修正</li>
<li>1 * -1 がエラーになる問題修正</li>
<li>disableerrormsgが有効のとき、「文字コード変換できない文字が含まれています。かまわずに保存しますか？」のメッセージは出さないようにして、常にかまわず保存してしまうようにする</li>
<li>Unicodeの文字列対応<br />
文字列型変数の中で""として、0000の部分に16進数4桁でUnicodeを記述</li>
<li>Unicode対応の修正<br />
insert, insertfix, overwrite,leftstr, rightstr, midstr,strlen, strstr, message,gettext, gettext2, setclipboard, addclipboard, getclipboard</li>
<li>Unicode非対応の修正<br />
ascii 半角のUnicode独自文字は半角の?(0x3f)として，全角のUnicode独自文字は全角の？(0x8148)として扱う</li>
<li>replaceall で linknext を指定すると、３つ以上開いている場合 result の値が一致しない問題修正</li>
<li>question文もUnicodeの文字列に対応（message,questionともNT系のみ）</li>
<li>タブ操作関係の追加<br />
tabmode,tabgroup,taborder,tabtotal,settabmode,settabgroup,settaborder</li>
<li>messageなどがUnicode対応によって、日本語以外のエンコードの種類になっているとき文字化けしてしまっていた問題修正</li>
<li>コマンド追加<br />
tabgrouptotal,tabgrouporder,gettabhandle(),getcurrenttab(),foundbuffer,foundoption</li>
<li>settabgropで64以上を指定するとまずい問題修正</li>
<li>setwindowsizeでセカンダリモニタが左にある場合などの修正</li>
<li>ヘルプ内のグループ番号という呼び名をグループIDに変更</li>
<li>setmonitorでワークエリアによるウィンドウの調整がされるときサイズがなるべく変化しないようにする</li>
<li>closehidemruでタブモードで異なるウィンドウのタブを閉じると、アクティブウィンドウが移動してしまう問題修正</li>
<li>浮動小数点数バージョンでopenfileで長いファイル名を指定すると死ぬことがあった問題修正</li>
<li>getclipboardで8KBを超えるデータが扱えなくなってしまった問題修正</li>
<li>ステルス秀丸エディタ上でexit;すると次のウィンドウにアクティブが移らない場合がある問題修正。</li>
<li>golineend3 追加。「行末に移動（その２）」相当。</li>
<li>unicharの追加、unicodeの引数版の追加。</li>
<li>setencode 26;でバイナリモードにも変更可能にする。</li>
<li>menu文,input関数も""によるUnicodeの文字の表示を可能にする。</li>
<li>configset文追加。</li>
<li>currentconfigsetキーワード追加。</li>
<li>openfile, loadfileなどのオプションにnoaddhistを追加。</li>
<li>openfile "";で新規作成されない場合がある問題修正。</li>
<li>fontmodeキーワード追加</li>
<li>menuarrayなどの縦書きモード対応</li>
</ul>
<h3 id="spec">【２】仕様変更</h3>
<ul>
<li>gettextに第５パラメタを指定して、範囲選択を維持することができるようにする</li>
<li>nexttab, prevtabではウィンドウ分割の移動はできないようにする</li>
<li>localgrepでfullpathができるようにする</li>
<li>findwindowの第二パラメタでクラス名を同時に指定できるようにする</li>
<li>directtagjumpで候補のダイアログでキャンセルした場合はresultを -1 にする</li>
<li>config文で数値の記述でマイナスも書けるようにする</li>
<li>marklistでキャンセルした場合resultに-1を設定する</li>
<li>marklistで他の秀丸エディタに移動してもマクロ実行の切り替えを行う</li>
<li>setsearchのフラグのビット１３をセットしないと、ビット１１，１２は有効でないようにする</li>
<li>searchoptionのビット１３は常にセットする</li>
<li>gettextとgettext2で、ファイルの最後を超える行を指定した場合は、ファイルの終端に修正して指定するようにする</li>
<li>getclipboardでフォントが日本語のときUnicodeから日本語への変換をするようにする</li>
<li>loadhilightをした後に、強調表示一覧の枠を更新するようにする</li>
<li>検索文字列に強調関係の仕様変更。既存のマクロでは、検索文字列の強調に影響を与えないようにする</li>
<li>getconfig("Tategaki")では、一時的な状態の縦書きを取得するようにする</li>
<li>colorcodeの仕様変更<br />
検索文字列の強調は 27 ではなく、0x00010000 のビットにして、他の強調と重なり合っていても、colorcodeの値は維持するようにする。</li>
<li>filter文は動作環境で変換モジュールを追加していなくてもできるようにする。</li>
<li>setactivehidemaruにパラメタ追加。二番目のパラメタでウィンドウを指定して、そのウィンドウの下にＺオーダーを移動。</li>
<li>columntox(-1,1)は0を返すようにする。</li>
<li>文字列内にUnicode独自の文字が含まれていない場合は、message文やmenu文など、なるべく従来通りの動作となるようにする。（日本語以外のWindowsの場合に影響）</li>
<li>insertfile でオプション指定可能にする。</li>
<li>grep文でエンコードの種類を指定できるようにする。</li>
<li>grepの実行・grep文でUnicode独自の文字なども使用できるようにする。</li>
<li>loadfile, readonlyloadfile, readonlyopenfile でもオプションでエンコードの種類を指定できるようにする。</li>
<li>grepdialog文のresultは、キャンセル時は-1、ヒット時はヒット数を正しく返すようにする。</li>
<li>saveas文で bom, nobom オプションを付けてBOMを付けるかどうかを指定できるようにする。</li>
<li>menu文でメニューを出している間は右上の閉じるボタンを押せないようにする。</li>
<li>forceinselect 1;finddown;で行単位となる警告のメッセージは出ないようにする。</li>
</ul>
</div>
<hr />
<p><a href="hmindex0.html">目次に戻る</a></p>
</body>
</html>
