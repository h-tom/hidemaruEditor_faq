<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="Shift_JIS" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第II部〜知っていると便利な秀丸の機能　CSV/TSVモード</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="base.css" />
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="hmindex0.html"><img src="hide_by2.png" alt="Hidemaru Q and A" width="88" height="32" /></a></p>
<h1 id="TOP">第II部〜知っていると便利な秀丸の機能<br>　CSV/TSVモード</h1>
<hr />
<h2 id="CSVMODE">●CSV/TSVモード</h2>
<p>秀丸エディタ Ver.8.00以降では、「<strong>CSV/TSVモード</strong>」が使用可能です。</p>
<p>エディタ画面上で、CSV(カンマ区切りテキスト)、TSV(タブ区切りテキスト)を、表計算ソフトの様に<span class="attention_red">表示するモード</span>です。</p>
<p>表計算ソフトのように計算する機能はありません。また、表計算ソフトのような<strong>「セル内での改行」には対応していません。</strong></p>
<p>TSV/CSVモードの場合、動作が変わる機能があります。 詳細は、秀丸エディタのヘルプー<a href="https://help.maruo.co.jp/hidemaru/html/080_Config_FormTab_TsvCsv.html" class="externallink" target="_blank">「TSVモード/CSVモード」</a>を 参照してください。</p>
<ul>
<li><a href="#EXPLANATION">解説</a></li>
<li><a href="#SUPPLEMENTATION">補足</a></li>
</ul>
<!-- h3 -->
<div class="marginleft">
<h3 id="EXPLANATION">[解説]</h3>
<p>普通の設定で、CSVファイルを開いた状態です。</p>
<p><img src="2_csv_tsv_01.png" alt="通常モード" width="644" height="344" /><br />
</p>
<p>「CSVモード」でCSVファイルを開いた状態です。(<span class="attention_red">縦と横のガイドラインを表示</span>)<br />
カンマやタブを区切り文字として、表計算ソフトのように<span class="attention_red">表示する事が可能</span>です。</p>
<p><img src="2_csv_tsv_02.png" alt="CSVモード" width="662" height="366" /><br />
</p>
<p>CSVモードにするには、「メニュー」から設定する方法と、「<span class="filetype">ファイルタイプ別の設定</span>」から変更する方法があります。</p>
<ul>
<li><p>メニューは「表示」−「タブストップ」−「CSVモード(カンマ区切り)」で設定します。</p>
<p><img src="2_csv_tsv_03.png" alt="メニューから設定" width="616" height="626" /><br />
</p></li>
<li><p>「<span class="filetype">ファイルタイプ別の設定</span>」は「体裁」ー「タブ」−「タブの文字数」で設定します。</p>
<p><img src="2_csv_tsv_04.png" alt="ファイルタイプ別の設定から設定" width="632" height="286" /><br />
</p></li>
</ul>
<p>一時的に表示を変更したい場合にはメニューから変更する方がお手軽です。</p>
<hr />
<p>CSV/TSVモード特有の動作として、ルーラ部のカラムをクリックする事で、列全体を選択する事が可能です。 そのままドラッグして、列を移動させることも可能です。</p>
<p><img src="2_csv_tsv_11.png" alt="列の選択" width="560" height="260" /><br />
</p>
<p>また、ルーラ部のカラムを右クリックすることで、その列をキーにしたソートが可能です。</p>
<p><img src="2_csv_tsv_15.png" alt="列のキーにしたソート" width="502" height="307" /><br />
</p>
<!-- h4 -->
<div class="marginleft">
<h4 id="EXPLANATION-1">設定</h4>
<p>「<span class="filetype">ファイルタイプ別の設定</span>」ではなく、「<span class="env">動作環境</span>」という扱いです。</p>
<ul>
<li><p>「<strong>TSV/CSVモードの詳細</strong>」<br />
「メニュー」や、「<span class="filetype">ファイルタイプ別の設定</span>」−「体裁」−「タブ」から設定画面を開くことが出来ます。 セル幅の自動調整等が設定できます。</p>
<p>詳細は<a href="https://help.maruo.co.jp/hidemaru/html/070_Env_Edit_TsvCsv.html" class="externallink" target="_blank">ヘルプ：TSV/CSVモードの詳細</a>を参照してください。</p>
<p><img src="2_csv_tsv_05.png" alt="TSV/CSVモードの詳細" width="427" height="212" /><br />
</p></li>
<li><p>「<strong>ルーラの詳細</strong>」<br />
TSV/CSVモードのカラム表示方法を設定できます。 「<span class="filetype">ファイルタイプ別の設定</span>」−「体裁」−「タブ」にある「ルーラの詳細」から設定画面を開くことが出来ます。</p>
<p>詳細は<a href="https://help.maruo.co.jp/hidemaru/html/070_Env_User_Cursor2.html" class="externallink" target="_blank">ヘルプ：ルーラの詳細</a>を参照してください。</p>
<p><img src="2_csv_tsv_06.png" alt="ルーラの詳細" width="343" height="320" /><br />
</p>
<p>「目盛り」は、半角1文字ずつの目盛りを表示します、</p>
<p>ABCの設定</p>
<p><img src="2_csv_tsv_07.png" alt="ルーラの詳細(A,B)" width="550" height="136" /><br />
</p>
<p>123の設定</p>
<p><img src="2_csv_tsv_08.png" alt="ルーラの詳細(1,2)" width="550" height="136" /><br />
</p>
<p>桁数</p>
<p><img src="2_csv_tsv_09.png" alt="ルーラの詳細(桁数)" width="550" height="136" /><br />
</p></li>
<li><p>「<span class="filetype">ファイルタイプ別の設定</span>」の「デザイン」で「ガイドライン(縦)」と「ガイドライン(横)」を、 表示するようにすると、Excelのセルっぽく表示することが出来ます。</p>
<p><img src="2_csv_tsv_10.png" alt="ガイドラインの表示" width="480" height="219" /><br />
</p></li>
</ul>
</div>
<h3 id="SUPPLEMENTATION">[補足]</h3>
<ul>
<li><p>検索時の注意点</p>
<p>例えば、以下の状態で、項目(セル)内の「最高気温」だけを検索する場合を考えます。(「最高気温時」にはマッチさせない。)</p>
<p><img src="2_csv_tsv_14.png" alt="CSVモード表示例2" width="662" height="175" /><br />
</p>
<ul>
<li><p>単純に「最高気温」で検索した場合は、「最高気温」と「最高気温時」にマッチしてしまいます。</p></li>
<li><p>項目(セル)内の内容ということで、正規表現を使用し「^最高気温$」で検索しても、マッチしません。</p>
<p>これは、実際には</p>
<!-- macro -->
<div class="macro">
<pre><code>日,最高気温,最高気温起時,最低気温,最低気温起時,平均気温,日照積算量</code></pre>
</div>
<p>という内容を検索しているため、<code>^</code>と<code>$</code>は、行頭と行末になるためマッチしません。 (項目内の先頭、末尾にはならない)</p></li>
</ul>
<p>項目(セル)内のみマッチさせるには、正規表現の、前方一致(戻り読み)と後方一致(先読み)を使います。</p>
<!-- macro -->
<div class="macro">
<pre><code>(?&lt;=^|,)最高気温(?=$|,)</code></pre>
</div>
<p>正規表現を使用するため、検索内容に正規表現のメタ文字がある場合はエスケープする必要があります。</p>
<p>または、</p>
<!-- macro -->
<div class="macro">
<pre><code>(?&lt;=^|,)\Q最高気温\E(?=$|,)</code></pre>
</div>
<p>という感じで、検索したい内容を、<code>\Q</code>と<code>\E</code>で囲みます。</p>
<p>CSVの場合は <code>","</code> が区切り文字となりますが、TSVの場合は、<code>"\t"</code> を使います。</p>
<!-- macro -->
<div class="macro">
<pre><code>(?&lt;=^|\t)\Q最高気温\E(?=$|\t)</code></pre>
</div></li>
<li><p>指定した列のみ検索対象にしたい場合は、カラーマーカーを使います。</p>
<ol type="1">
<li><p>検索対象にしたい列全体を選択します。(ルーラー部分をクリックすれば、列全体を選択できます)</p></li>
<li><p>メニューの「検索」−「カラーマーカー」−「一時的なカラーマーカーを付ける」を選び、カラーマーカーを付けます。</p></li>
<li><p>対象にしたい列に対し、1.〜2.を繰り返します。</p></li>
<li><p>検索ダイアログを表示させ、「追加の条件」にチェックを入れ、範囲を「<strong>「一時的なカラーマーカー」の範囲</strong>」に設定します。 「追加の条件」に関しては、<a href="2_find.html">「第II部〜知っていると便利な秀丸の機能　検索」</a>にある、 <a href="2_find.html#SUPPLEMENTATION-1">「追加の条件」</a>を参照してください。</p>
<p><img src="2_csv_tsv_12.png" alt="検索ダイアログ-追加の条件" width="433" height="244" /><br />
</p></li>
<li><p>これで、検索を実行すれば、指定した列(カラーマーカーを付けた列)のみを、検索の対象に出来ます。</p></li>
</ol></li>
<li><p>区切り文字の <code>colorcode</code></p>
<p>CSVモードでも、区切り文字である "," の<code>colorcode</code>は、"0x00000020(タブ)"がセットされます。</p></li>
<li><p>区切り文字の表示</p>
<p>TSV/CSVモードの場合、設定によっては 区切り文字(CSVの場合は","、TSVの場合はタブ文字)は表示されません。<br />
表示する場合は、「<span class="filetype">ファイルタイプ別の設定</span>」-「デザイン」-「場所の一覧」にある「タブ文字」にチェックを入れます。 (CSVの場合も、「タブ文字」にチェックを入れてください。)</p>
<p><img src="2_csv_tsv_17.png" alt="場所の一覧-タブ文字" width="465" height="128" /><br />
</p>
<p>CSVモードで、「タブ文字」にチェックを入れ、区切り文字を表示した場合<br />
<img src="2_csv_tsv_16.png" alt="区切り文字の表示" width="485" height="109" /><br />
</p></li>
</ul>
</div>
<hr />
<p><a href="hmindex0.html">目次に戻る</a></p>
</body>
</html>
