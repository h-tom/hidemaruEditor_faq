<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="Shift_JIS" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第IV部〜テキスト編集を極める！！　起動オプションを使ってみよう</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="base.css" />
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="hmindex0.html"><img src="hide_by2.png" width="88" height="32" alt="Hidemaru Q and A" /></a></p>
<h1 id="top">第IV部〜テキスト編集を極める！！<br>　起動オプションを使ってみよう</h1>
<hr />
<h2 id="option">起動オプションを使ってみよう</h2>
<p>秀丸エディタに限らず、Windowsのアプリケーションの多くで、「<span class="font_red_bold">起動オプション</span>」を使うことができます。これによって、そのアプリケーションをどんな状態で起動させるかや、起動してすぐに実行したい処理などを指示できます。起動オプションをうまく使うと、単にアプリケーションを起動するだけとはひとあじ違う使い方ができるわけで、こんなイイものを使わない手はないでしょう。(^_^)</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">秀丸エディタの場合</th>
<th style="text-align: left;">は、</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">/b</td>
<td style="text-align: left;">秀丸エディタを閲覧モードで起動します。</td>
</tr>
</tbody>
</table>
<p>/j行番号,桁番号 ファイルを開いてから，指定された行にカーソルを移動します。</p>
<p>/xマクロ名 秀丸エディタ起動と同時にマクロを実行します。</p>
<p>/fe /fj など オープンするファイルの文字コードを指定します。 ―――――- ―――――――――――――――――――-</p>
<p>Table:秀丸エディタ 起動オプションの例</p>
<p>のような起動オプションを利用できます。（詳しくは秀丸エディタヘルプ<a href="https://help.maruo.co.jp/hidemaru/html/230_Option.html" class="externallink" target="_blank" rel="noopener">秀丸エディタ起動時のオプション</a>を参照してください）</p>
<p>この起動オプションは、「<strong>コマンドライン</strong>」で利用できます。コマンドラインというのは、起動したいアプリケーション名とその起動オプション・開きたいファイル名を『<strong>文字で</strong>』記述することで、そのアプリケーションを起動できるモノを指します（←ちょっといい加減な説明(^^;)）。<br />
例えば、「ファイル名を指定して実行(R)」がそれに当たります。</p>
<p><img src="4_cmdline_01.png" width="399" height="206" alt="ファイル名を指定して実行" /><br />
</p>
<p>また、Windowsでは「<strong>コマンドプロンプト</strong>」「<strong>PowerShell</strong>」でも同様に Windowsアプリケーションを起動できたりします。</p>
<p>実は、Windowsの「<strong>ショートカット</strong>」や「<strong>アプリケーションとの関連付け</strong>」でもコマンドラインの仕組みを使っています。<br />
例えば、ショートカットの場合、ショートカットのプロパティの「<strong>リンク先</strong>」がコマンドラインになっています。<br />
ショートカットは、デスクトップ上に置いて使う以外にも、右クリックメニューの中の「<strong>送る</strong>」の機能を追加するために使うことができます。「送る」の送り先は、ユーザーフォルダ内のフォルダに置かれたショートカットなので、そこへショートカットを作成すれば「送る」に追加されます。 (「ファイル名を指定して実行(R)」や「送る」のフォルダを開く方法は「<a href="#SUPPLEMENT">補足</a>」-「<a href="#SUPPLEMENT-1">「送る」のフォルダを開く方法</a>」を参照)</p>
<p>ということは、ショートカットの「<strong>リンク先</strong>」のところに起動オプションを書き加えておいて、そこにファイルを<strong>ドラッグ&amp;ドロップ</strong>すれば（または「<strong>送る</strong>」）、いつもと一味違う秀丸エディタが立ち上がって便利便利、ということになるはずです。</p>
<p>【１】<a href="#DRAGDROP">ショートカットへの「ドラッグ&amp;ドロップ」の場合</a><br />
【２】<a href="#REG">「アプリケーションとの関連付け」の場合</a><br />
【３】<a href="#info">注意点など</a><br />
【４】<a href="#CMD">コマンドプロンプトでの応用</a><br />
【５】<a href="#SUPPLEMENT">補足</a></p>
<!-- h3 -->
<div class="marginleft">
<h3 id="DRAGDROP">【１】ショートカットへの「ドラッグ&amp;ドロップ」の場合</h3>
<p>ここでは例題として、デスクトップ上に「秀丸エディタを閲覧モードで開く」ショートカットを作成して、そこにファイルをドラッグ&amp;ドロップするとそのファイルが閲覧モードで開くようにしてみましょう。</p>
<p>試しに、秀丸エディタのショートカットを作成して、そのプロパティの「リンク先」の最後に</p>
<pre><code>...\Hidemaru.exe /b</code></pre>
<p>というふうに 半角スペースと"/b" を追加してみてください。</p>
<p><img src="4_cmdline_02.png" width="421" height="580" alt="ショートカットの設定ダイアログ" /><br />
</p>
<div class="box_line">
<dl>
<dt>※ショートカットの簡単な作り方：</dt>
<dd>エクスプローラで秀丸エディタをインストールしたフォルダを開きます。 Hidemaru.exe を右ドラッグ（Hidemaru.exe の上でマウスの右ボタンを押してボタンを離さずにマウスを移動させる）して、デスクトップ上でボタンから手を離します。メニューから「ショートカットをここに作成(S)」を選べば作れます。
</dd>
</dl>
</div>
<p>できたショートカットをダブルクリックすると、新規作成の秀丸エディタが閲覧モードで起動します。何にもない画面を閲覧モードで開いてもちっとも嬉しくありませんが(^^;)、とりあえずちゃんと起動オプションは効いているようです。</p>
<p>今回は"/b"を指定し閲覧モードで開くようにしましたが、grepを起動するようにしたり、「デスクトップ復元」を行うようにできます。</p>
<h3 id="REG">【２】「アプリケーションとの関連付け」の場合</h3>
<p>残念ながら Windows Vista以降、"開く"アプリケーションの変更はできますが、右クリックメニューにユーザー独自の「閲覧モードで開く」等の追加が、簡単にはできなくなっています。 (レジストリエディタで直接レジストリを編集すれば可能)</p>
<p>起動オプションを指定したい場合には、ショートカットで指定するか、ファイルの種類によって切り換えることはできませんが「送る」を使うのが簡単です。</p>
<h3 id="info">【３】注意点など</h3>
<!-- h3 -->
<div class="marginleft">
<h4 id="info-1">ファイル名に空白を含む場合</h4>
<p>コマンドラインは、他のアプリケーションを起動したり他のアプリケーションから起動されたり等、色々使われているので簡単に注意点を示します。</p>
<p>コマンドラインで、各パラメータ(/b 等)の区切りには、半角スペースが使用されます。また、Windowsではファイルやフォルダの名前に半角スペースが使用可能です。その為、半角スペースを含む名前を指定する場合には、注意が必要です。</p>
<div class="box_line2">
<pre><code>例)秀丸エディタの標準的なインストール先
　 C:\Program Files\Hidemaru\Hidemaru.exe</code></pre>
</div>
<p>この<code>C:\Program Files\Hidemaru\Hidemaru.exe</code> を単純に半角スペースで分割すると、</p>
<div class="box_line2">
<pre><code>「C:\Program」と「Files\Hidemaru\Hidemaru.exe」</code></pre>
</div>
<p>になり、<code>hidemaru.exe</code> を起動する事が出来ません。(<code>C:\Program</code> が見つかりませんと言われる)</p>
<p>その為、半角スペースを含む場合には、全体を「"」(ダブルクオート)で囲みます。</p>
<div class="box_line2">
<pre><code>&quot;C:\Program Files\Hidemaru\Hidemaru.exe&quot;</code></pre>
</div>
<p>秀丸エディタのショートカットで、リンク先のパスが「"」(ダブルクオート)で囲まれているのは、このためです。</p>
<p>秀丸エディタでファイルを指定して開く場合も同じで、対象のファイルパスに半角スペースを含む場合は、全体を「"」(ダブルクオート)で囲みます。</p>
<div class="box_line2">
<pre><code>例)秀丸エディタで同じフォルダにあるファイルを開く場合。
&quot;C:\Program Files\Hidemaru\Hidemaru.exe&quot; &quot;C:\Program Files\Hidemaru\hidemaru.txt&quot;</code></pre>
</div>
<p>秀丸エディタは柔軟にファイル判定するらしく、ファイル名を「"」で囲まなくてもファイルを開いてくれますが、なるべく囲むようにしてください。</p>
<div class="box_line2">
<pre><code>//この状態でも問題なくファイルを開いてくれる。
&quot;C:\Program Files\Hidemaru\Hidemaru.exe&quot; C:\Program Files\Hidemaru\hidemaru.txt</code></pre>
</div>
<p>上記のように柔軟に判定してくれるのありがたいのですが、以下のようにファイルを2個開きたい場合は、 "空白を含むパス"と優先して認識するようでファイルが開けません。</p>
<div class="box_line2">
<pre><code>//カレントフォルダにファイルが2個あって開きたい場合。
&quot;C:\Program Files\Hidemaru\Hidemaru.exe&quot; file1.txt file2.txt

実行すると、&quot;file1.txt file2.txt&quot; という新規ファイルを開く。</code></pre>
</div>
<p>ファイルを複数開くには、以下の方法があります。</p>
<ul>
<li><p>方法1 ファイル名を「"」(ダブルクォートで囲む)。</p>
<pre><code>&quot;C:\Program Files\Hidemaru\Hidemaru.exe&quot; &quot;file1.txt&quot; &quot;file2.txt&quot;</code></pre></li>
<li><p>方法2 ファイル名をフルパスで指定する。(ダブルクォートが無くてもファイルの区切りが認識可能)</p>
<pre><code>&quot;C:\Program Files\Hidemaru\Hidemaru.exe&quot; C:\TEMP\file1.txt C:\TEMP\file2.txt</code></pre></li>
</ul>
<h4 id="info-2">オプションを指定する場所</h4>
<p>オプションを指定する場合、記述する場所も重要になります。</p>
<div class="box_line2">
<pre><code>// &quot;C:\Program Files\Hidemaru\hidemaru.txt&quot; を 開き、 そのファイルに test.mac を実行したい。
&quot;C:\Program Files\Hidemaru\Hidemaru.exe&quot; &quot;C:\Program Files\Hidemaru\hidemaru.txt&quot; /x test.mac</code></pre>
</div>
<p>この記述だと、"C:\Program Files\Hidemaru\hidemaru.txt" は開きますが、test.mac は "無題"の秀丸エディタが開き、そこで実行されます。<br />
("/x test.mac" の後に無題の秀丸エディタを指定している状態)</p>
<p>"C:\Program Files\Hidemaru\hidemaru.txt" は開き、そのファイル上で、test.mac を実行するには以下の記述になります。<br />
(<strong>ファイルを指定する場合、起動オプションは、ファイルより前に指定しなければならない</strong>)</p>
<div class="box_line2">
<pre><code>// &quot;C:\Program Files\Hidemaru\hidemaru.txt&quot; を 開き、 そのファイルに test.mac を実行したい。
&quot;C:\Program Files\Hidemaru\Hidemaru.exe&quot; /x test.mac &quot;C:\Program Files\Hidemaru\hidemaru.txt&quot;</code></pre>
</div>
<p>マクロを実行する場合、複数のファイルを指定しても、最初のファイルしか開かないようです。</p>
<div class="box_line2">
<pre><code>// マクロの実行と、ファイルを2個指定した場合。
&quot;C:\Program Files\Hidemaru\Hidemaru.exe&quot; /x test.mac  &quot;file1.txt&quot; &quot;file2.txt&quot;
file1.txt を開き test.mac を実行するが、file2.txt は開かない。</code></pre>
</div>
</div>
<h3 id="CMD">【４】コマンドプロンプトでの応用</h3>
<p>コマンドプロンプトを使うと、複数のファイルにマクロを実行できます。 (実行するマクロはチョットした注意点があります)</p>
<p>以下は、ワイルドカードで指定したファイルに対し、マクロを実行するバッチファイルです。<br />
秀丸エディタのパスや、実行するマクロ名 "実行するマクロ.mac" は、適宜書き換えてください。</p>
<div class="macro">
<pre><code>@echo off
if not &quot;%1&quot; == &quot;&quot; goto MAIN
echo 検索するファイルのワイルドカードを指定してください。
goto :EOF

:MAIN
for %%a in (%1) do start &quot;&quot; /wait &quot;C:\Program Files\Hidemaru\Hidemaru.exe&quot; /x 実行するマクロ.mac &quot;%%a&quot;</code></pre>
</div>
<p>上記内容をバッチファイルとして保存しワイルドカードを引数に指定して実行すると、ワイルドカードにマッチしたファイルに対しマクロ(実行するマクロ.mac)を実行します。</p>
<p>ただし、開いた秀丸エディタを閉じないと、次のファイルに進みません。自動処理で使用する場合には、マクロ内でファイルを閉じる操作が必要です。 (exit文 または quit文 を使う)</p>
<p>バッチファイルだと「<code>start "" /wait</code>」は不要ですが、確実に終了待ちを行うため追加しています。コマンドプロンプトで、for文を直接実行する場合には、「<code>start "" /wait</code>」は必ず必要になります。</p>
</div>
<h3 id="SUPPLEMENT">【５】補足</h3>
<!-- h3 -->
<section id="SUPPLEMENT-1" class="marginleft">
<h4>「送る」のフォルダを開く方法</h4>
<p>「送る」は「ユーザーフォルダ内のフォルダ」と説明しましたが、そのフォルダを開く方法です。</p>
<ul>
<li><p>「ファイル名を指定して実行」を使う場合。</p>
<p>「ファイル名を指定して実行」は、「スタートボタン」の右クリックメニューや、<kbd>[Windows]</kbd>+<kbd>[R]</kbd>キーを押すと実行できます。</p>
<p>「ファイル名を指定して実行」ダイアログが開いたら、「名前」に「<code>shell:sendto</code>」を入力し「OK」を押す。</p></li>
<li><p>コマンドプロンプト、PowerShellで以下を入力する。</p>
<div class="macro">
<pre><code>explorer shell:sendto</code></pre>
</div></li>
</ul>
</section>
<hr />
<p><a href="hmindex0.html">目次に戻る</a></p>
</body>
</html>
