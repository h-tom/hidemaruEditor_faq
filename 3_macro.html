<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="Shift_JIS" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第III部〜秀丸マクロのいろはにほへと　マクロを実行してみよう</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="base.css" />
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="hmindex0.html"><img src="hide_by2.png" width="88" height="32" alt="Hidemaru Q and A" /></a></p>
<h1 id="TOP">第III部〜秀丸マクロのいろはにほへと<br>　マクロを実行してみよう</h1>
<hr />
<h2 id="INDEX">マクロを実行してみよう</h2>
<div class="title-li">
<ul>
<li>【０】<a href="#ABOUT">ここに書いてあること</a></li>
<li>【１】<a href="#PRE">導入前の準備</a></li>
<li>【２】<a href="#INSTALL">個々のマクロの導入</a></li>
<li>【３】<a href="#RUN">一番原始的なマクロの実行</a></li>
<li>【４】<a href="#REGIST">マクロ登録</a></li>
<li>【５】<a href="#SHORTCUT">ショートカットキーへの登録</a></li>
<li>【６】<a href="#TOOLBAR">ツールバーからマクロ起動</a></li>
<li>【７】<a href="#USERMENU">ユーザーメニューからマクロ起動</a></li>
<li>【８】<a href="#SAMPLE">サンプルマクロ</a></li>
</ul>
</div>
<!-- h3 -->
<div class="marginleft">
<h3 id="ABOUT">【０】ここに書いてあること</h3>
<p>秀丸エディタの大きな魅力の1つに「秀丸マクロ」の存在があげられます。マクロというのは一種のプログラムで、これを利用することにより秀丸エディタ上で行う作業を自動化したり秀丸エディタの機能を拡張したりと、秀丸エディタをより便利に使うことができます。マクロは自分で作ってもよいし（実際、単純なマクロを組むのは、それほど難しいことではありません）、人の作ったものをなんらかの方法で入手してもいいでしょう<a href="#exp1">(注1)</a>。なお、手元に適当なマクロがない人は、<a href="#SAMPLE">【８】</a>にサンプルのマクロをいくつか用意しておきましたので、それを元に自分でマクロファイルを作っていろいろ実行させてみましょう。(^_^)</p>
<p>秀丸エディタのマクロの正体は、秀丸エディタのマクロ言語が記述された「MAC」という拡張子のついたテキストファイルです。以下これをマクロファイルと呼びます。ここでは、マクロ（マクロファイル）を入手してから、それを実際に利用するまでの手順を説明します。</p>
<hr />
<dl>
<dt><span id="exp1">注1</span>:</dt>
<dd><p>例えば、以下の場所には、多くの秀丸エディタマクロが登録されています。</p>
<ul>
<li>秀まるおさんのホームページのライブラリ (<a href="https://hide.maruo.co.jp/lib/index.html" class="externallink" target="_blank" rel="noopener">https://hide.maruo.co.jp/lib/index.html</a>)</li>
<li>Vector (<a href="https://www.vector.co.jp/vpack/filearea/win/writing/edit/hm/index.html" class="externallink" target="_blank" rel="noopener">https://www.vector.co.jp/vpack/filearea/win/writing/edit/hm/index.html</a>)</li>
</ul>
</dd>
</dl>
<h3 id="PRE">【１】導入前の準備</h3>
<p>まず、このマクロファイルを格納するためのフォルダを作らなければなりません。</p>
<p><strong>Windows Vista以降の場合</strong>、デフォルトではユーザーフォルダにある、アプリケーションデータフォルダに設定されています。</p>
<pre><code>    例) C:\Users\ユーザー名\AppData\Roaming\Hidemaruo\Hidemaru\Macro</code></pre>
<p>ストアアプリ版の場合、マクロフォルダはドキュメントフォルダに設定されます。</p>
<pre><code>    例) %USERPROFILE%\Documents\Hidemaru\StoreAppMacro</code></pre>
<p>マクロフォルダはユーザーフォルダでなくてもかまいませんが、書き込み可能なフォルダを指定してください。フォルダの名前は任意に指定可能です。<a href="#exp2">(注2)</a></p>
<p>デフォルト以外の場所にマクロフォルダを作成した場合には、設定を変更する必要があります。メニューの「その他 → <span class="env">動作環境</span>」で動作環境を開き、「環境」にある「パス」の「マクロファイル用のフォルダ」で設定します。</p>
<p><img src="3_macro_01.png" width="604" height="189" alt="環境-パス" /><br />
</p>
<p>タイプミスをするといけないので<strong>[参照…]</strong>ボタンを押して、先ほど作成したフォルダを選択してください。 <strong>&lt;OK&gt;</strong>を選んで設定を終了します。<strong>&lt;キャンセル&gt;</strong>で終了すると、設定を変更したことにはならないので注意して下さい。</p>
<p>これで作業は終了です。この作業は最初に１回だけやる必要があります。マクロ用フォルダの名前や場所を変えない限り、この作業をやりなおす必要はありません。</p>
<hr />
<p>ストアアプリ版では「環境変数」を含むパスが設定されますが、デスクトップ版でもパスに「環境変数」を含めることは可能です。(Ver.8.40以降)<br />
デフォルト設定の場合、環境変数を使った場合は、以下のようになります。</p>
<pre><code>    例) %APPDATA%\Hidemaruo\Hidemaru\Macro</code></pre>
<p>「環境変数」を含める利点は、「設定内容の保存/復元」を使い保存し、別環境で復元するという作業がやりやすいことです。直接フルパスで記入した場合、Windowsのログオンユーザー名なども含め同じでない場合は、必ず設定の変更が必要になります。環境変数を使えば、ログオンユーザー名などは環境変数に含まれるため、設定の変更は不要です。<br />
(環境変数が使えるのは、マクロ用と設定用のフォルダ指定です。すべてのパス設定で環境変数が使えるわけではない為、何も設定変更しなくても良いというわけではありません)</p>
<hr />
<dl>
<dt><span id="exp2">注2</span></dt>
<dd><p>Windows Vista以降のOSは、通常の権限では"OSで保護された領域"にファイルの書き込みが出来ません(管理者権限へ昇格が必要)。秀丸エディタのデフォルトインストール先は、"C:\Program Files\Hidemaru"ですが、 "C:\Program Files"以下は、"OSで保護された領域"となるので、マクロフォルダの作成には向いていません。 (64bit OSで、32bit版秀丸エディタを使っている場合、インストール先は"C:\Program Files(x86)\Hidemaru"になり、ここも保護されたフォルダになります)</p>
<p>デフォルトマクロフォルダが指定されているユーザーフォルダは、エクスプローラでも見えないような設定になっています(OS側の設定)。見えるようにするにはOSの設定を変更する必要があります。 (「フォルダーオプション」の「隠しファイル、隠しフォルダー、および隠しドライブを表示する」を選ぶ)</p>
<p><img src="3_macro_02.png" width="444" height="540" alt="フォルダーオプション" /><br />
</p>
<p>OS側の設定を変更したくない場合は、ユーザーフォルダ以外にマクロフォルダを作成する必要があります。</p>
<p>秀丸エディタの仕様ではマクロ用のフォルダは必ずしも準備しなくてもいいことになっていますが、 <span class="font_red_bold">Windows Vista以降のOSでは、必ず指定するようにしてください。</span>空欄だと、秀丸エディタ本体と同じ場所を指定した事になってしまいます。</p>
</dd>
</dl>
<h3 id="INSTALL">【２】個々のマクロの導入（前提：【１】）</h3>
<div class="attention1">
<p>マクロファイルは通常、マクロ用フォルダに置きます。</p>
</div>
<p>データライブラリに登録されているマクロの場合は LHAやZIP形式で圧縮されている場合がほとんどですから、マクロ用フォルダに展開（解凍）します。またドキュメント以外の添付ファイルがある場合、それらの中にはマクロの実行に必要なものが含まれている可能性があります。ドキュメント等をよく読んでその指示に従って下さい。</p>
<h3 id="RUN">【３】一番原始的なマクロの実行（前提：【１】【２】）</h3>
<div class="attention1">
<p>「とりあえず実行してみる」には、メニューから「マクロ→マクロ実行」を選びます。</p>
</div>
<p>ダイアログの中に、【１】でマクロ用フォルダに含まれるマクロファイルのリストが表示されます。その中から実行したいマクロファイルを選び、ファイル名のテキストボックスの中にそのファイル名が表示されたのを確認してから<strong>&lt;OK&gt;</strong>をクリックします。これで、そのマクロが実行されます。</p>
<p><img src="3_macro_execute.png" width="406" height="395" alt="マクロの実行ダイアログ" /><br />
</p>
<p>マクロ実行ダイアログは変更可能です。「<span class="env">動作環境</span> − 環境 − 高度な環境 − マクロ実行ダイアログ」で設定します。</p>
<p><img src="3_macro_execute3.png" width="605" height="70" alt="マクロの実行ダイアログの設定" /><br />
</p>
<p>「参照ダイアログ」の場合、ファイル選択ダイアログが開きます。マクロをフォルダで分類しているような場合には、こちらのダイアログの方が便利でしょう。</p>
<p><img src="3_macro_execute2.png" width="650" height="476" alt="マクロの実行　参照ダイアログ" /><br />
</p>
<h3 id="REGIST">【４】マクロ登録（前提：【１】【２】）</h3>
<div class="attention1">
<p>【３】の方法は、マクロを実行する度にリストから選ばなければならないので面倒です。またマクロファイルが多くなってくると、ファイル名だけではどれが何のマクロか分からなくなってきます。そこで、比較的頻繁に使用するようなマクロは「マクロ登録」してしまいましょう。マクロ登録すると、プルダウンメニューからマクロを実行できるようになるほか、以下の手段からでも利用できるようになります。</p>
<ul>
<li>ショートカットキーによるマクロの実行（→<a href="#SHORTCUT">【５】</a>）</li>
<li>ツールバーのアイコンからのマクロの実行（→<a href="#TOOLBAR">【６】</a>）</li>
<li>ユーザーメニューからのマクロの実行（→<a href="#USERMENU">【７】</a>）</li>
</ul>
</div>
<p>まず「マクロ→マクロ登録」で「マクロ登録」ダイアログを呼び出します。マクロ登録では「マクロ1」から「マクロ80」まで80個のマクロを登録できます。これらは「1〜10」「11〜20」という風に10個づつのグループとなっています。ダイアログの左側にある「対象」で、これらを切り替えることができます。</p>
<p>「1〜10」グループに登録したマクロは、「マクロ」のプルダウンメニューの中にタイトルが表示され、そこから直接起動できます。「11〜20」グループ以降に登録したものは、プルダウンメニューの中にグループ名が表示されます。グループ名を選択すると、該当するグループに登録されたマクロのタイトルのメニューが表示され、そこからマクロを起動できます。</p>
<p>メニューの「マクロ」を開いたところ<br />
<img src="HMM0012A_01.png" width="417" height="306" alt="マクロのメニュー" /><br />
</p>
<p>マクロ登録ダイアログは、バージョンにより異なります。</p>
<ul>
<li><a href="#V879">Ver.8.79以降</a></li>
<li><a href="#V877">Ver.8.77まで</a></li>
</ul>
<hr />
<dl>
<dt><span id="V879">Ver.8.79以降</span></dt>
<dd><p>Ver.8.79からは、ダイアログが変更されています。<br />
追加したい場所を選択後、画面下段にあるタイトルとファイル名の入力欄で、各項目を入力します。<br />
ファイル名右側の「<strong><span class="rotate90">＞</span></strong>」ボタンでリストが出ます。「<strong>…</strong>」ボタンで、ファイル参照ダイアログを使って、マクロファイルを選択できます。</p>
<p>エクスプローラからのドロップにも対応していて、マクロをエクスプローラから登録したい箇所にドロップすれば、タイトルとファイル名が設定されます。タイトルはファイル名から拡張子を削除したものが自動にセットされるので、必要に応じて変更してください。<br />
右下の「開く」ボタンを押すと、エクスプローラでマクロフォルダが開きます。</p>
<p>ドロップ中に、グループの切替は出来ないので、あらかじめ登録したいグループ選択しておいてください。とりあえずドロップし、移動したい項目を選択後、「上へ」、「下へ」のボタンで、移動する事も出来ます。 (「上へ」、「下へ」のボタンは、グループを超えて移動できます)</p>
<p>Ver.8.79以降のマクロ登録ダイアログ(左下の「モード」から旧ダイアログにも変更可能です。キー割り当ても表示できます)<br />
<img src="3_macro_registration2.png" width="606" height="415" alt="マクロの登録" /><br />
</p>
</dd>
</dl>
<hr />
<dl>
<dt><span id="V877">Ver.8.77まで</span></dt>
<dd><p>マクロ登録の基本は「タイトル」と「ファイル名」の指定です。まず「ファイル名」の欄に、セットアップしたマクロファイルの名前を入力します。右側の「<strong><span class="rotate90">＞</span></strong>」ボタンでリストが出ます。「<strong>…</strong>」ボタンで、ファイル参照ダイアログを使って、マクロファイルを選択できます。</p>
<p>次に、任意の「タイトル名」を入力します。このタイトルがプルダウンメニュー等に表示されますので、マクロの機能がすぐにわかるような名前を付けましょう。</p>
<p>Ver.8.77までの画面<br />
<img src="3_macro_registration.png" width="606" height="415" alt="マクロの登録" /><br />
</p>
</dd>
</dl>
<hr />
<p>グループが「１〜１０」以外の場合は上にある「グループ名」の欄にも任意の名前を入力して下さい<a href="#exp3">(注3)</a>。作業が終わったらをクリックしてマクロ登録を終了します。</p>
<dl>
<dt><span id="exp3">注3</span></dt>
<dd>ここでグループ名を入力しないと、プルダウンメニューにグループ名が表示されません。また、「１〜１０」グループにはグループ名は付けられません。
</dd>
</dl>
<h3 id="SHORTCUT">【５】ショートカットキーへの登録（前提：【１】【２】【４】）</h3>
<p>マクロ登録後、プルダウンメニューを見ると、「マクロ1」から「マクロ9」に登録したものは、それぞれ右側に「Ctrl+1」などと表示されています。これは「文章を入力・編集しているときに、<kbd>[CTRL]</kbd>を押しながら<kbd>[1]</kbd>を押すと、マクロ1が実行される」という意味です。つまり「マクロ1」から「マクロ9」に登録したマクロは、（何番に何のマクロが登録されているかを憶えてさえいれば）実はプルダウンメニューを表示させなくても呼び出すことができるのです<a href="#exp4">(注4)</a>。このような特定のキーの組み合わせによって、メニューなどを介さずに直接コマンドなどを実行する機能（およびそのキーの組み合わせ）のことを一般に「ショートカットキー」といいます。</p>
<div class="attention1">
<p>秀丸エディタのショートカットキーはかなり高い自由度でカスタマイズできるようになっており、「マクロ80」までに登録したマクロは任意（といってももちろんある程度の制限はありますが）のショートカットキーに割り付けることができます。ここでは、マクロ登録したマクロをショートカットキーに割り付ける方法を説明します。</p>
</div>
<p>まず「その他→キー割り当て」でキー割り当てのダイアログを呼び出します。</p>
<ul>
<li><p>秀丸エディタ Ver.8.90以降の場合 (Ver.8.90〜)「キーに対するコマンド」の場合</p>
<div style="position:relative;">
<p><img src="2_custom_31.png" width="737" height="401" alt="キー割り当てのダイアログ" /> <img src="keymap_v890.png" width="737" height="401" alt="キー割り当てのダイアログ-v890" style="position: absolute; left: 0px; top: 0px;"/></p>
</div>
<p>「キーの一覧」には、割り当てることのできる「キー」と現在割り当てている「コマンド」の一覧が表示されます。「キーの一覧」の内容は、その下の「Shift/Ctrl/Alt」と、右にある「キー割り当て拡張」のチェックとの組み合わせで変化します。</p>
<p>「キーの一覧」から割り当てたいキーを選択すると、「割り当てるコマンド」で該当するコマンドが選択されます。</p>
<p>「割り当てるコマンド」に表示されたコマンドをクリックして選択することにより、「キーの一覧」で選択したキーに割り当てるコマンドを変更(あるいは新規に設定)できます。<a href="#exp5">(注5)</a></p>
<p>検索ボックス右側の「<span class="rotate90">＞</span>」で表示されるリストから「メニュー/マクロ」を選ぶと、項目の絞り込みが行われ、メニューとマクロのみ表示させることができます</p></li>
<li><p>秀丸エディタ Ver.8.90より前の場合 (〜Ver.8.89)</p>
<p><img src="keymap.png" width="497" height="314" alt="キー割り当てのダイアログ" /><br />
</p>
<p>左側の「キー」のリストには割り当てることのできるキー(すでにコマンドが割り当てられているキーを含む)の一覧が表示されます。このキーリストの内容は、その下の「Shift/Ctrl/Alt/キー割り当て拡張」のチェックとの組み合わせで変化します。</p>
<p>キーリストの中からあるキーの組み合わせを選ぶ(クリックする)と、そのキーに登録されているコマンドが、中央の「コマンド」のリストの中で選択表示されます。「(なし)」が選択表示されている場合、そのキーにはまだコマンドが割り当てられていないということです。コマンド系列ボックス右側の「<span class="rotate90">＞</span>」で表示されるリストからコマンド系列を選び、その下のコマンドリストに表示されたコマンドの1つをクリックして選択表示させることにより、左側で指示したキーに割り当てるコマンドを変更(あるいは新規に設定)できます。<a href="#exp5">(注5)</a></p>
<p>マクロを設定する場合は、キー選択後コマンドを選択する際に「メニュー/マクロ」の系列を選び、コマンドリスト中の「マクロ1」から「マクロ80」の中から割り当てたいものをクリックします。</p></li>
</ul>
<p>例えば「<kbd>[Ctrl]</kbd>と<kbd>[Shift]</kbd>を押しながら<kbd>[C]</kbd>→マクロ15（に登録したマクロ） を実行」と設定したい場合、まず右下の</p>
<ul>
<li>&#9744;Shift(S)</li>
<li>&#9744;Ctrl(T)</li>
</ul>
<p>をチェック(クリックして&#9744;の中に&#9745;がついた状態にする)します。<br />
次にキーリストをスクロールさせて「Shift+Ctrl+C」をクリックして選択状態にして、「メニュー/マクロ」の系列を選んでから、コマンドリストをスクロールさせて「マクロ15:×××××」をクリックすることになります。</p>
<p><span class="btn-push">「OK」</span>をクリックして終了すると、登録したキー割り当てが有効になります。</p>
<hr />
<dl>
<dt><span id="exp4">注4</span>：</dt>
<dd>Ctrl+1〜Ctrl+9のキー割り当ては「マクロ1」〜「マクロ9」に固定されているようです。(デフォルトのキー割り当て) もちろんこれらのマクロを別のキーに「も」割り当てることは問題なくできます。
</dd>
<dt><span id="exp5">注5</span>：</dt>
<dd>順番に注意して下さい。必ず左側で「キー」を選んだ後に、右側で「コマンド」を選ばなければなりません。
</dd>
</dl>
<h3 id="TOOLBAR">【６】ツールバーからマクロ起動（前提：【１】【２】【４】）</h3>
<div class="attention1">
<p>【４】で登録したマクロに限って、ツールバーのアイコンから起動できます。</p>
</div>
<p>まず「その他→<span class="env">動作環境</span>→ウィンドウ」の「&#9744;ツールバー」の項目がチェックされていなかったら、これをチェックします。さらに[詳細]ボタンをクリックし、「ツールバー詳細」のダイアログを呼び出します。右側のボックスでコマンド系列に「メニュー/マクロ系」を指定すると、その下のリストに「マクロ1」から「マクロ10」までの（数字のデザインの）アイコンが表示されます。(11〜80まではアイコンがありません) これらは「マクロ登録」で「マクロ1」〜「マクロ80」へ割り当てたマクロに対応していますから、適宜選んで中央の[追加]ボタンをクリックすると、左側のツールバーリストの最後尾に追加されます。アイコンの並びは<span class="btn-push">「一つ上に」</span> <span class="btn-push">「一つ下に」</span>ボタンで調整します。作業が終わったら<span class="btn-push">&lt;OK&gt;</span>ボタンで終了します。</p>
<p>これで、メニューの下のツールバーの数字のアイコンから直接マクロを起動できるようになります。</p>
<p><img src="3_macro_toolbar.png" width="572" height="439" alt="ツールバーカスタマイズのダイアログ" /><br />
</p>
<p><img src="3_macro_toolbar2.png" width="579" height="133" alt="ツールバーカスタマイズ結果" /><br />
</p>
<h3 id="USERMENU">【７】ユーザーメニューからマクロ起動（前提：【１】【２】【４】）</h3>
<div class="attention1">
<p>秀丸エディタには「メニュー1」から「メニュー8」および「選択中右ボタン」という９つのユーザーメニュー(ユーザーが自由に編集できるメニュー)が用意されています。ここに「マクロ1」から「マクロ80」までのマクロを登録できます。これを利用するためには、「メニューの編集」と「メニューのキー割り当て」の２段階の準備が必要になります。</p>
</div>
<p>まずメニューの編集をします。「その他→メニュー編集」で「メニューの編集」のダイアログを呼び出し、「ユーザーメニュー」のタブを選択します。「メニュー」欄で編集するメニューを選択すると、そのメニューの現在の内容が「内容」のリストに表示されます。</p>
<p><img src="3_macro_usermenu.png" width="482" height="453" alt="ユーザーメニュー" /><br />
</p>
<p>[追加…]ボタンで「追加」ダイアログを呼び出します。</p>
<p><img src="3_macro_usermenu_add.png" width="322" height="333" alt="ユーザーメニューの追加" /><br />
</p>
<p>コマンド系列に「メニュー/マクロ」を指定すると、下のリストに「マクロ1」から「マクロ80」までが表示されます<a href="#exp6">(注6)</a>。メニューに追加したいものをクリックして選択表示させ、「キー」欄に半角英数字１文字を入力します（この半角英数字はメニュー内での一種のショートカットキーになります）。ここで[追加]をクリックすると、「ユーザーメニューの設定」ダイアログに戻るので、「内容」リストの末尾に先ほど指定したマクロが追加されていることを確認して下さい。必要なら並べ替え等をし、[閉じる]で終了します。これでメニューの編集は終わりです。</p>
<p>「メニュー1」から「メニュー8」の場合、次にメニューのキー割り当てをします<a href="#exp7">(注7)</a>。要領は【５】とほぼ同じです。違うのはコマンドリストから選ぶのが「マクロ」ではなく「メニュー」であるということだけです。</p>
<p>これで、割り当てられたショートカットキーによりユーザーメニューが表示され、その中からマクロを実行できるようになります。</p>
<hr />
<dl>
<dt><span id="exp6">注6</span>：</dt>
<dd>実際にはこのリスト中にユーザーメニューも含まれています。これを「追加」するとユーザーメニューの中にユーザーメニューを登録することになります。これによりユーザーメニューを階層化できるようです。
</dd>
<dt><span id="exp7">注7</span>：</dt>
<dd>「選択中右ボタン」に限り、「範囲選択中のマウス右クリック」に対応が固定されていますので、キー割り当ての作業は不要です（というかできません）。また、デフォルトの設定では「メニュー1」が「右クリック」に割り当てられているようです（キー割り当てのダイアログで確認できます）。したがってマウスの右クリックメニューからマクロを実行したい場合は、さしあたって「メニュー1」および「選択中右ボタン」に登録するのが簡単でしょう。こうすればキー割り当てで悩む必要はありません。特に「処理範囲を選択してから実行するマクロ」の場合「選択中右ボタン」に登録しておくと、マウスの左ボタンドラッグで範囲を選択した後、右クリックでメニューを出してすぐにマクロを実行できるので便利です。
</dd>
</dl>
<h3 id="SAMPLE">【８】サンプルマクロ</h3>
<div class="attention1">
<p>手元に適当なマクロファイルがない方は、次の要領でマクロファイルを作って動かしてみましょう。ただし【１】の導入前の準備は済ませておいて下さい。</p>
</div>
<ol type="1">
<li>以下のサンプルの中から好きなものを心に決める。(^_^)</li>
<li>Q&amp;A集のウィンドウのメニューの「編集→コピー」を選択する。(多少時間がかかるかもしれません)</li>
<li>心に決めたサンプルの「//―ここから」と「//―ここまで」で挟まれた部分をドラッグして選択し「一部分コピー」をクリックする。</li>
<li>秀丸エディタを起動し（あるいは「ファイル→新規作成」でまっさらな秀丸エディタを用意し）「編集→貼り付け」で先ほどコピーしたものを秀丸エディタにペーストする。</li>
<li>「ファイル→名前を付けて保存」を選び、下記の名前をつけてマクロ用フォルダ（【１】参照）に保存する。</li>
</ol>
<!-- h4 -->
<div class="marginleft">
<h4 id="SAMPLE1">サンプルマクロその１</h4>
<p>「カーソル位置に現在日時を挿入するマクロ」</p>
<p>保存時のファイル名は QA_SMPL1.MAC としてください。</p>
<div class="macro">
<pre><code>//---ここから
//QA_SMPL1.MAC
insert date + &quot; &quot; + time;
endmacro;
//---ここまで</code></pre>
</div>
<h4 id="SAMPLE2">サンプルマクロその２</h4>
<p>「編集中のテキストの末尾に『自分の名前』をの行を挿入するマクロ」</p>
<p>保存時のファイル名は QA_SMPL2.MAC としてください。<br />
「自分の名前」のところは任意の文字列（ただし「vや「"」を含まない）に置き換えることができます。</p>
<div class="macro">
<pre><code>//---ここから
//QA_SMPL2.MAC
gofileend;
insert &quot;\n&quot; + &quot;自分の名前&quot; + &quot;\n&quot;;
endmacro;
//---ここまで</code></pre>
</div>
<h4 id="SAMPLE3">サンプルマクロその３</h4>
<p>「改行のみの行が連続していたら１行に置換するマクロ」</p>
<p>保存時のファイル名は QA_SMPL3.MAC としてください。</p>
<div class="macro">
<pre><code>//---ここから
//QA_SMPL3.MAC
gofileend;
replaceup &quot;^\\n\\n+&quot;, &quot;\n&quot;, regular;
while (result) findup;
endmacro;
//---ここまで</code></pre>
</div>
<p>このマクロの意味の詳細は、<a href="4_regular.html">第IV部〜テキスト編集を極める！！正規表現について</a> の<a href="4_regular.html#RETURNS">【５】 (補足)秀丸エディタ上での複数行にまたがる検索について</a>を参照してください。</p>
<h4 id="SAMPLE4">サンプルマクロその４</h4>
<p>「空白（全角スペース、半角スペース、タブ）のみからなる行を改行のみの行に置換するマクロ」</p>
<p>保存時のファイル名は QA_SMPL4.MAC としてください。</p>
<div class="macro">
<pre><code>//---ここから
//QA_SMPL4.MAC
replaceall &quot;^[ 　\\t]+$&quot;,&quot;&quot;, regular;
endmacro;
//---ここまで</code></pre>
</div>
<p>※このマニュアルは秀丸エディタ Ver.3.08 の仕様を元に書かれています。秀丸エディタのバージョンによっては、必ずしもここに書かれている内容の通りとは限りません。</p>
</div>
</div>
<hr />
<p><a href="hmindex0.html">目次に戻る</a></p>
</body>
</html>
